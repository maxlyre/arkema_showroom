(self.webpackChunkstrapi=self.webpackChunkstrapi||[]).push([[5895],{93500:(q,L,n)=>{"use strict";n.r(L),n.d(L,{SettingsPage:()=>Sn,default:()=>Jn});var e=n(67294),v=n(68547),s=n(49656),z=n(78862),j=n(97132),ie=n(15482),le=n(59942),ce=n(8610),Me=n(23724),_=n(62031),B=n(5493),R=n(34626),Q=n(49425),Pe=n(9008),X=n(19408),de=n(70677),dt=n(43257),it=n.n(dt),tt=n(84734),Ie=n.n(tt),ne=n(45697),E=n.n(ne),Te=n(68397),nt=n(30741),Xe=n(80768),ye=n.n(Xe),fe=n(27590),Re=n.n(fe),Ye=n(73749);const lt={currentStep:void 0},Qe=(c=lt,u)=>(0,Ye.default)(c,l=>{switch(u.type){case"GO_TO":{l.currentStep=u.to;break}default:return l}});var je=n(75146);const ot={localImage:void 0},mt=(c=ot,u)=>(0,Ye.default)(c,l=>{switch(u.type){case"SET_LOCAL_IMAGE":{l.localImage=u.value;break}default:return l}}),w=({onChangeLogo:c,customLogo:u,goTo:l,Component:f,modalTitle:S,next:p,prev:F,currentStep:T})=>{const[{localImage:C},x]=(0,e.useReducer)(mt,ot),{formatMessage:te}=(0,j.useIntl)(),ge=Je=>{x({type:"SET_LOCAL_IMAGE",value:Je})},Ue=()=>{l(null)};return T?e.createElement(je.ModalLayout,{labelledBy:"modal",onClose:Ue},e.createElement(je.ModalHeader,null,e.createElement(Q.Typography,{fontWeight:"bold",as:"h2",id:"modal"},te(S))),e.createElement(f,{setLocalImage:ge,goTo:l,next:p,prev:F,onClose:Ue,asset:C||u,onChangeLogo:c})):null};w.defaultProps={Component:void 0,currentStep:void 0,customLogo:void 0,modalTitle:void 0,next:null,prev:null},w.propTypes={Component:E().elementType,currentStep:E().string,customLogo:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}),goTo:E().func.isRequired,modalTitle:E().shape({id:E().string,defaultMessage:E().string}),next:E().string,onChangeLogo:E().func.isRequired,prev:E().string};const Y=w,V=750,pe=100,Ae=["image/jpeg","image/png","image/svg+xml"];var K=n(11402),re=n(14276),he=n(78384),J=n(67826),be=n(15804),$e=n(91767),at=n(43435),rt=n.n(at),Et=(c,u,l)=>new Promise((f,S)=>{var p=C=>{try{T(l.next(C))}catch(x){S(x)}},F=C=>{try{T(l.throw(C))}catch(x){S(x)}},T=C=>C.done?f(C.value):Promise.resolve(C.value).then(p,F);T((l=l.apply(c,u)).next())});const gt={id:"Settings.application.customization.modal.upload.error-format",defaultMessage:"Wrong format uploaded (accepted formats only: jpeg, jpg, png, svg)."},W={id:"Settings.application.customization.modal.upload.error-size",defaultMessage:"The file uploaded is too large (max dimension: {dimension}x{dimension}, max file size: {size}KB)"},ee=c=>new Promise(u=>{const l=new FileReader;l.onload=()=>{const f=new Image;f.onload=function(){u({width:f.width,height:f.height})},f.src=l.result},l.readAsDataURL(c)}),oe=(c,u)=>({ext:c.name.split(".").pop(),size:c.size/1e3,name:c.name,url:URL.createObjectURL(c),rawFile:c,width:u.width,height:u.height}),y=c=>Et(void 0,null,function*(){let u;if(!Ae.includes(c.type))throw u=new Error("File format"),u.displayMessage=gt,u;const f=yield ee(c);if(!(f.width<=V&&f.height<=V))throw u=new Error("File sizing"),u.displayMessage=W,u;const p=oe(c,f);if(!(p.size<=pe))throw u=new Error("File sizing"),u.displayMessage=W,u;return p});var Ve=(c,u,l)=>new Promise((f,S)=>{var p=C=>{try{T(l.next(C))}catch(x){S(x)}},F=C=>{try{T(l.throw(C))}catch(x){S(x)}},T=C=>C.done?f(C.value):Promise.resolve(C.value).then(p,F);T((l=l.apply(c,u)).next())});const ft=(0,he.default)($e.FieldInput)`
  opacity: 0;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
`,ct=({setLocalImage:c,goTo:u,next:l,onClose:f})=>{const{formatMessage:S}=(0,j.useIntl)(),[p,F]=(0,e.useState)(!1),[T,C]=(0,e.useState)(void 0),x=(0,e.useRef)(null),te=()=>F(!0),ge=()=>F(!1),Ue=_e=>{_e.preventDefault(),x.current.click()},Je=()=>Ve(void 0,null,function*(){ge();const _e=x.current.files[0];if(!!_e)try{const Ze=yield y(_e);c(Ze),u(l)}catch(Ze){if(Ze.displayMessage)C(S(Ze.displayMessage,{size:pe,dimension:V})),x.current.focus();else throw Ze}}),qe=()=>p?"primary500":T?"danger600":"neutral300";return e.createElement(e.Fragment,null,e.createElement("form",null,e.createElement(B.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement($e.Field,{name:"logo-upload",error:T},e.createElement("label",{htmlFor:"logo-upload"},e.createElement(Pe.Stack,{spacing:2},e.createElement(J.Flex,{paddingTop:9,paddingBottom:7,hasRadius:!0,justifyContent:"center",direction:"column",background:p?"primary100":"neutral100",borderColor:qe(),borderStyle:"dashed",borderWidth:"1px",position:"relative",onDragEnter:te,onDragLeave:ge},e.createElement(be.Icon,{color:"primary600",width:`${60/16}rem`,height:`${60/16}rem`,as:rt(),"aria-hidden":!0}),e.createElement(B.Box,{paddingTop:3,paddingBottom:5},e.createElement(Q.Typography,{variant:"delta",as:"span"},S({id:"Settings.application.customization.modal.upload.drag-drop",defaultMessage:"Drag and Drop here or"}))),e.createElement(ft,{accept:Ae,cursor:"pointer",as:"input",type:"file",name:"files",tabIndex:-1,zIndex:1,onChange:Je,ref:x,id:"logo-upload"}),e.createElement(X.Button,{type:"button",onClick:Ue},S({id:"Settings.application.customization.modal.upload.cta.browse",defaultMessage:"Browse files"})),e.createElement(B.Box,{paddingTop:6},e.createElement(Q.Typography,{variant:"pi",textColor:"neutral600"},S({id:"Settings.application.customization.modal.upload.file-validation",defaultMessage:"Max dimension: {dimension}x{dimension}, Max size: {size}KB"},{size:pe,dimension:V})))),e.createElement($e.FieldError,null)))))),e.createElement(je.ModalFooter,{startActions:e.createElement(X.Button,{onClick:f,variant:"tertiary"},S({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"}))}))};ct.defaultProps={next:null},ct.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const ue=ct;var De=n(55967),Fe=n(9669),Rn=n.n(Fe),Dn=(c,u,l)=>new Promise((f,S)=>{var p=C=>{try{T(l.next(C))}catch(x){S(x)}},F=C=>{try{T(l.throw(C))}catch(x){S(x)}},T=C=>C.done?f(C.value):Promise.resolve(C.value).then(p,F);T((l=l.apply(c,u)).next())});const tn=c=>Dn(void 0,null,function*(){try{const u=yield Rn().get(c,{responseType:"blob",timeout:8e3});return new File([u.data],u.config.url,{type:u.headers["content-type"]})}catch(u){throw u.displayMessage={id:"Settings.application.customization.modal.upload.error-network",defaultMessage:"Network error"},u}});var nn=(c,u,l)=>new Promise((f,S)=>{var p=C=>{try{T(l.next(C))}catch(x){S(x)}},F=C=>{try{T(l.throw(C))}catch(x){S(x)}},T=C=>C.done?f(C.value):Promise.resolve(C.value).then(p,F);T((l=l.apply(c,u)).next())});const Bt=({goTo:c,next:u,onClose:l,setLocalImage:f})=>{const{formatMessage:S}=(0,j.useIntl)(),[p,F]=(0,e.useState)(""),[T,C]=(0,e.useState)(null),x=ge=>{F(ge.target.value)},te=()=>nn(void 0,null,function*(){try{const ge=yield tn(p),Ue=yield y(ge);f(Ue),c(u)}catch(ge){if(ge.displayMessage)C(S(ge.displayMessage,{size:pe,dimension:V}));else throw ge}});return e.createElement("form",{onSubmit:ge=>{ge.preventDefault(),te()}},e.createElement(B.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(De.TextInput,{label:S({id:"Settings.application.customization.modal.upload.from-url.input-label",defaultMessage:"URL"}),error:T,onChange:x,value:p,name:"logo-url"})),e.createElement(je.ModalFooter,{startActions:e.createElement(X.Button,{onClick:l,variant:"tertiary"},S({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(X.Button,{type:"submit"},S({id:"Settings.application.customization.modal.upload.next",defaultMessage:"Next"}))}))};Bt.defaultProps={next:null},Bt.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const lo=Bt,Ot=({setLocalImage:c,goTo:u,next:l,onClose:f})=>{const{formatMessage:S}=(0,j.useIntl)();return e.createElement(K.TabGroup,{label:S({id:"Settings.application.customization.modal.tab.label",defaultMessage:"How do you want to upload your assets?"}),variant:"simple"},e.createElement(B.Box,{paddingLeft:8,paddingRight:8},e.createElement(K.Tabs,null,e.createElement(K.Tab,null,S({id:"Settings.application.customization.modal.upload.from-computer",defaultMessage:"From computer"})),e.createElement(K.Tab,null,S({id:"Settings.application.customization.modal.upload.from-url",defaultMessage:"From url"}))),e.createElement(re.Divider,null)),e.createElement(K.TabPanels,null,e.createElement(K.TabPanel,null,e.createElement(ue,{onClose:f,setLocalImage:c,goTo:u,next:l})),e.createElement(K.TabPanel,null,e.createElement(lo,{onClose:f,setLocalImage:c,goTo:u,next:l}))))};Ot.defaultProps={next:null},Ot.propTypes={goTo:E().func.isRequired,next:E().string,onClose:E().func.isRequired,setLocalImage:E().func.isRequired};const co=Ot;var vt=n(73962);const on=({asset:c})=>{const{formatMessage:u}=(0,j.useIntl)();return e.createElement(vt.Card,null,e.createElement(vt.CardHeader,null,e.createElement(vt.CardAsset,{size:"S",src:c.url})),e.createElement(vt.CardBody,null,e.createElement(vt.CardContent,null,e.createElement(vt.CardTitle,null,c.name),e.createElement(vt.CardSubtitle,null,`${c.ext.toUpperCase()} - ${c.width}\u2715${c.height}`)),e.createElement(vt.CardBadge,null,u({id:"Settings.application.customization.modal.pending.card-badge",defaultMessage:"image"}))))};on.propTypes={asset:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}).isRequired};const an=on,Ut=({onClose:c,asset:u,prev:l,next:f,goTo:S,setLocalImage:p,onChangeLogo:F})=>{const{formatMessage:T}=(0,j.useIntl)(),C=()=>{p(void 0),S(l)},x=()=>{F(u),S(f)};return e.createElement(e.Fragment,null,e.createElement(B.Box,{paddingLeft:8,paddingRight:8,paddingTop:6,paddingBottom:6},e.createElement(J.Flex,{justifyContent:"space-between",paddingBottom:6},e.createElement(J.Flex,{direction:"column",alignItems:"flex-start"},e.createElement(Q.Typography,{variant:"pi",fontWeight:"bold"},T({id:"Settings.application.customization.modal.pending.title",defaultMessage:"Logo ready to upload"})),e.createElement(Q.Typography,{variant:"pi",textColor:"neutral500"},T({id:"Settings.application.customization.modal.pending.subtitle",defaultMessage:"Manage the chosen logo before uploading it"}))),e.createElement(X.Button,{onClick:C,variant:"secondary"},T({id:"Settings.application.customization.modal.pending.choose-another",defaultMessage:"Choose another logo"}))),e.createElement(B.Box,{maxWidth:(0,v.pxToRem)(180)},e.createElement(an,{asset:u}))),e.createElement(je.ModalFooter,{startActions:e.createElement(X.Button,{onClick:c,variant:"tertiary"},T({id:"Settings.application.customization.modal.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(X.Button,{onClick:x},T({id:"Settings.application.customization.modal.pending.upload",defaultMessage:"Upload logo"}))}))};Ut.defaultProps={next:null,prev:null},Ut.propTypes={goTo:E().func.isRequired,asset:E().shape({name:E().string,url:E().string,width:E().number,height:E().number,ext:E().string}).isRequired,next:E().string,onClose:E().func.isRequired,onChangeLogo:E().func.isRequired,prev:E().string,setLocalImage:E().func.isRequired};const Mn={upload:{Component:co,modalTitle:{id:"Settings.application.customization.modal.upload",defaultMessage:"Upload logo"},next:"pending",prev:null},pending:{Component:Ut,modalTitle:{id:"Settings.application.customization.modal.pending",defaultMessage:"Pending logo"},next:null,prev:"upload"}},Rt=({customLogo:c,defaultLogo:u,onChangeLogo:l,onResetMenuLogo:f})=>{const[{currentStep:S},p]=(0,e.useReducer)(Qe,lt),{Component:F,next:T,prev:C,modalTitle:x}=Mn[S]||{},{formatMessage:te}=(0,j.useIntl)(),ge=Ue=>{p({type:"GO_TO",to:Ue})};return e.createElement(e.Fragment,null,e.createElement(Te.CarouselInput,{label:te({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"}),selectedSlide:0,hint:te({id:"Settings.application.customization.carousel-hint",defaultMessage:"Change the admin panel logo (Max dimension: {dimension}x{dimension}, Max file size: {size}KB)"},{size:pe,dimension:V}),previousLabel:"",nextLabel:"",onNext:()=>{},onPrevious:()=>{},secondaryLabel:(c==null?void 0:c.name)||"logo.png",actions:e.createElement(Te.CarouselActions,null,e.createElement(nt.IconButton,{onClick:()=>ge(c?"pending":"upload"),label:te({id:"Settings.application.customization.carousel.change-action",defaultMessage:"Change logo"}),icon:e.createElement(ye(),null)}),c&&e.createElement(nt.IconButton,{onClick:f,label:te({id:"Settings.application.customization.carousel.reset-action",defaultMessage:"Reset logo"}),icon:e.createElement(Re(),null)}))},e.createElement(Te.CarouselSlide,{label:te({id:"Settings.application.customization.carousel-slide.label",defaultMessage:"Logo slide"})},e.createElement(B.Box,{maxHeight:"40%",maxWidth:"40%",as:"img",src:(c==null?void 0:c.url)||u,alt:te({id:"Settings.application.customization.carousel.title",defaultMessage:"Logo"})}))),e.createElement(Y,{Component:F,currentStep:S,onChangeLogo:l,customLogo:c,goTo:ge,next:T,prev:C,modalTitle:x}))};Rt.defaultProps={customLogo:null},Rt.propTypes={customLogo:E().shape({url:E().string,name:E().string}),defaultLogo:E().string.isRequired,onChangeLogo:E().func.isRequired,onResetMenuLogo:E().func.isRequired};const rn=Rt,jt={menuLogo:{display:null,submit:{rawFile:null,isReset:!1}}},po=(c=jt,u)=>(0,Ye.default)(c,l=>{switch(u.type){case"SET_CUSTOM_MENU_LOGO":{l.menuLogo.display=u.value,l.menuLogo.submit.rawFile=u.value.rawFile;break}case"RESET_CUSTOM_MENU_LOGO":{l.menuLogo.display=null,l.menuLogo.submit={rawFile:null,isReset:!0};break}default:return l}});var Gt=n(82492),mo=n.n(Gt);const go=(c,u)=>mo()(c,{menuLogo:{display:u.menuLogo}}),Vt=(0,e.forwardRef)(({projectSettingsStored:c},u)=>{const{formatMessage:l}=(0,j.useIntl)(),{trackUsage:f}=(0,v.useTracking)(),{logos:{menu:S}}=(0,le.um)(),[{menuLogo:p},F]=(0,e.useReducer)(po,jt,()=>go(jt,c)),T=x=>{F({type:"SET_CUSTOM_MENU_LOGO",value:x})},C=()=>{f("didClickResetLogo"),F({type:"RESET_CUSTOM_MENU_LOGO"})};return(0,e.useImperativeHandle)(u,()=>({getValues:()=>({menuLogo:p.submit})})),e.createElement(B.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(Q.Typography,{variant:"delta",as:"h3"},l({id:"Settings.application.customization",defaultMessage:"Customization"})),e.createElement(R.Grid,{paddingTop:4},e.createElement(R.GridItem,{col:6,s:12},e.createElement(rn,{onChangeLogo:T,customLogo:p.display,defaultLogo:S.default,onResetMenuLogo:C}))))});Vt.defaultProps={projectSettingsStored:null},Vt.propTypes={projectSettingsStored:E().shape({menuLogo:E().shape({url:E().string,name:E().string})})};const In=Vt;var sn=n(23998),fo=n(68718),Lt=n.n(fo),ho=Object.defineProperty,xt=Object.defineProperties,ln=Object.getOwnPropertyDescriptors,Zt=Object.getOwnPropertySymbols,cn=Object.prototype.hasOwnProperty,Fn=Object.prototype.propertyIsEnumerable,zt=(c,u,l)=>u in c?ho(c,u,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[u]=l,un=(c,u)=>{for(var l in u||(u={}))cn.call(u,l)&&zt(c,l,u[l]);if(Zt)for(var l of Zt(u))Fn.call(u,l)&&zt(c,l,u[l]);return c},dn=(c,u)=>xt(c,ln(u));const Kt=c=>Lt()(c,(u,l,f)=>{l&&l.url?u[f]=dn(un({},l),{url:(0,v.prefixFileUrlWithBackendUrl)(l.url)}):u[f]=l},{});var pn=(c,u,l)=>new Promise((f,S)=>{var p=C=>{try{T(l.next(C))}catch(x){S(x)}},F=C=>{try{T(l.throw(C))}catch(x){S(x)}},T=C=>C.done?f(C.value):Promise.resolve(C.value).then(p,F);T((l=l.apply(c,u)).next())});const vo=()=>pn(void 0,null,function*(){const{data:c}=yield sn.be.get("/admin/project-settings");return Kt(c)}),wn=c=>pn(void 0,null,function*(){const{data:u}=yield sn.be.post("/admin/project-settings",c);return Kt(u)}),jn=c=>{const u=new FormData;return Object.entries(c).forEach(([l,f])=>{f&&f.rawFile instanceof File&&u.append(l,f.rawFile),f&&f.isReset&&u.append(l,null)}),u};var mn=(c,u,l)=>new Promise((f,S)=>{var p=C=>{try{T(l.next(C))}catch(x){S(x)}},F=C=>{try{T(l.throw(C))}catch(x){S(x)}},T=C=>C.done?f(C.value):Promise.resolve(C.value).then(p,F);T((l=l.apply(c,u)).next())});const Nn=[{action:"admin::project-settings.update",subject:null}],Eo=()=>{const c=(0,e.useRef)(),u=(0,v.useNotification)(),{trackUsage:l}=(0,v.useTracking)(),{formatMessage:f}=(0,j.useIntl)(),S=(0,Me.useQueryClient)();(0,v.useFocusWhenNavigate)();const p=(0,v.useAppInfos)(),{shouldUpdateStrapi:F,latestStrapiReleaseTag:T,strapiVersion:C}=p,{updateProjectSettings:x}=(0,le.um)(),{data:te}=(0,Me.useQuery)("project-settings",vo),ge=p.communityEdition?"app.components.UpgradePlanModal.text-ce":"app.components.UpgradePlanModal.text-ee",Ue=(0,Me.useMutation)(qe=>wn(qe),{onSuccess:qe=>mn(void 0,[qe],function*({menuLogo:_e}){yield S.invalidateQueries("project-settings",{refetchActive:!0}),x({menuLogo:_e==null?void 0:_e.url})})}),Je=()=>{const qe=c.current.getValues(),_e=jn(qe);Ue.mutate(_e,{onSuccess:()=>{const{menuLogo:Ze}=qe;Ze.rawFile&&l("didChangeLogo")},onError:()=>{u({type:"warning",message:{id:"notification.error",defaultMessage:"An error occurred"}})}})};return e.createElement(z.Layout,null,e.createElement(v.SettingsPageTitle,{name:"Application"}),e.createElement(_.Main,null,e.createElement(z.HeaderLayout,{title:f({id:"Settings.application.title",defaultMessage:"Overview"}),subtitle:f({id:"Settings.application.description",defaultMessage:"Administration panel\u2019s global information"}),primaryAction:e.createElement(X.Button,{onClick:Je,startIcon:e.createElement(Ie(),null)},f({id:"global.save",defaultMessage:"Save"}))}),e.createElement(z.ContentLayout,null,e.createElement(Pe.Stack,{spacing:6},e.createElement(B.Box,{hasRadius:!0,background:"neutral0",shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingRight:7,paddingLeft:7},e.createElement(Pe.Stack,{spacing:5},e.createElement(Q.Typography,{variant:"delta",as:"h3"},f({id:"global.details",defaultMessage:"Details"})),e.createElement(R.Grid,{paddingTop:1},e.createElement(R.GridItem,{col:6,s:12},e.createElement(Q.Typography,{variant:"sigma",textColor:"neutral600"},f({id:"Settings.application.strapiVersion",defaultMessage:"strapi version"})),e.createElement(Q.Typography,{as:"p"},"v",C),e.createElement(de.Link,{href:p.communityEdition?"https://discord.strapi.io":"https://support.strapi.io/support/home",isExternal:!0,endIcon:e.createElement(it(),null)},f({id:"Settings.application.get-help",defaultMessage:"Get help"}))),e.createElement(R.GridItem,{col:6,s:12},e.createElement(Q.Typography,{variant:"sigma",textColor:"neutral600"},f({id:"Settings.application.edition-title",defaultMessage:"current plan"})),e.createElement(Q.Typography,{as:"p"},f({id:ge,defaultMessage:`${p.communityEdition?"Community Edition":"Enterprise Edition"}`})))),e.createElement(R.Grid,{paddingTop:1},e.createElement(R.GridItem,{col:6,s:12},F&&e.createElement(de.Link,{href:`https://github.com/strapi/strapi/releases/tag/${T}`,isExternal:!0,endIcon:e.createElement(it(),null)},f({id:"Settings.application.link-upgrade",defaultMessage:"Upgrade your admin panel"}))),e.createElement(R.GridItem,{col:6,s:12},e.createElement(de.Link,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(it(),null)},f({id:"Settings.application.link-pricing",defaultMessage:"See all pricing plans"})))),e.createElement(B.Box,{paddingTop:1},e.createElement(Q.Typography,{variant:"sigma",textColor:"neutral600"},f({id:"Settings.application.node-version",defaultMessage:"node version"})),e.createElement(Q.Typography,{as:"p"},p.nodeVersion)))),te&&e.createElement(v.CheckPermissions,{permissions:Nn},e.createElement(In,{ref:c,projectSettingsStored:te}))))))};var gn=n(94654),kn=n.n(gn);const Wn=c=>kn()(c,l=>l.links).map(l=>(0,ce.ot)(l.Component,l.to,l.exact||!1)),Un=c=>c.filter(u=>!u.links.every(l=>l.isDisplayed===!1));var fn=n(42982),hn=n(71002),Ct=n(15861);function Oe(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Oe=function(){return c};var c={},u=Object.prototype,l=u.hasOwnProperty,f=typeof Symbol=="function"?Symbol:{},S=f.iterator||"@@iterator",p=f.asyncIterator||"@@asyncIterator",F=f.toStringTag||"@@toStringTag";function T(b,g,D){return Object.defineProperty(b,g,{value:D,enumerable:!0,configurable:!0,writable:!0}),b[g]}try{T({},"")}catch(b){T=function(D,I,U){return D[I]=U}}function C(b,g,D,I){var U=g&&g.prototype instanceof ge?g:ge,Z=Object.create(U.prototype),ve=new Jt(I||[]);return Z._invoke=function(ut,ht,se){var we="suspendedStart";return function(yt,_t){if(we==="executing")throw new Error("Generator is already running");if(we==="completed"){if(yt==="throw")throw _t;return qt()}for(se.method=yt,se.arg=_t;;){var An=se.delegate;if(An){var It=Pn(An,se);if(It){if(It===te)continue;return It}}if(se.method==="next")se.sent=se._sent=se.arg;else if(se.method==="throw"){if(we==="suspendedStart")throw we="completed",se.arg;se.dispatchException(se.arg)}else se.method==="return"&&se.abrupt("return",se.arg);we="executing";var Tt=x(ut,ht,se);if(Tt.type==="normal"){if(we=se.done?"completed":"suspendedYield",Tt.arg===te)continue;return{value:Tt.arg,done:se.done}}Tt.type==="throw"&&(we="completed",se.method="throw",se.arg=Tt.arg)}}}(b,D,ve),Z}function x(b,g,D){try{return{type:"normal",arg:b.call(g,D)}}catch(I){return{type:"throw",arg:I}}}c.wrap=C;var te={};function ge(){}function Ue(){}function Je(){}var qe={};T(qe,S,function(){return this});var _e=Object.getPrototypeOf,Ze=_e&&_e(_e(kt([])));Ze&&Ze!==u&&l.call(Ze,S)&&(qe=Ze);var Pt=Je.prototype=ge.prototype=Object.create(qe);function qn(b){["next","throw","return"].forEach(function(g){T(b,g,function(D){return this._invoke(g,D)})})}function Nt(b,g){function D(U,Z,ve,ut){var ht=x(b[U],b,Z);if(ht.type!=="throw"){var se=ht.arg,we=se.value;return we&&(0,hn.Z)(we)=="object"&&l.call(we,"__await")?g.resolve(we.__await).then(function(yt){D("next",yt,ve,ut)},function(yt){D("throw",yt,ve,ut)}):g.resolve(we).then(function(yt){se.value=yt,ve(se)},function(yt){return D("throw",yt,ve,ut)})}ut(ht.arg)}var I;this._invoke=function(U,Z){function ve(){return new g(function(ut,ht){D(U,Z,ut,ht)})}return I=I?I.then(ve,ve):ve()}}function Pn(b,g){var D=b.iterator[g.method];if(D===void 0){if(g.delegate=null,g.method==="throw"){if(b.iterator.return&&(g.method="return",g.arg=void 0,Pn(b,g),g.method==="throw"))return te;g.method="throw",g.arg=new TypeError("The iterator does not provide a 'throw' method")}return te}var I=x(D,b.iterator,g.arg);if(I.type==="throw")return g.method="throw",g.arg=I.arg,g.delegate=null,te;var U=I.arg;return U?U.done?(g[b.resultName]=U.value,g.next=b.nextLoc,g.method!=="return"&&(g.method="next",g.arg=void 0),g.delegate=null,te):U:(g.method="throw",g.arg=new TypeError("iterator result is not an object"),g.delegate=null,te)}function Tn(b){var g={tryLoc:b[0]};1 in b&&(g.catchLoc=b[1]),2 in b&&(g.finallyLoc=b[2],g.afterLoc=b[3]),this.tryEntries.push(g)}function Qt(b){var g=b.completion||{};g.type="normal",delete g.arg,b.completion=g}function Jt(b){this.tryEntries=[{tryLoc:"root"}],b.forEach(Tn,this),this.reset(!0)}function kt(b){if(b){var g=b[S];if(g)return g.call(b);if(typeof b.next=="function")return b;if(!isNaN(b.length)){var D=-1,I=function U(){for(;++D<b.length;)if(l.call(b,D))return U.value=b[D],U.done=!1,U;return U.value=void 0,U.done=!0,U};return I.next=I}}return{next:qt}}function qt(){return{value:void 0,done:!0}}return Ue.prototype=Je,T(Pt,"constructor",Je),T(Je,"constructor",Ue),Ue.displayName=T(Je,F,"GeneratorFunction"),c.isGeneratorFunction=function(b){var g=typeof b=="function"&&b.constructor;return!!g&&(g===Ue||(g.displayName||g.name)==="GeneratorFunction")},c.mark=function(b){return Object.setPrototypeOf?Object.setPrototypeOf(b,Je):(b.__proto__=Je,T(b,F,"GeneratorFunction")),b.prototype=Object.create(Pt),b},c.awrap=function(b){return{__await:b}},qn(Nt.prototype),T(Nt.prototype,p,function(){return this}),c.AsyncIterator=Nt,c.async=function(b,g,D,I,U){U===void 0&&(U=Promise);var Z=new Nt(C(b,g,D,I),U);return c.isGeneratorFunction(g)?Z:Z.next().then(function(ve){return ve.done?ve.value:Z.next()})},qn(Pt),T(Pt,F,"Generator"),T(Pt,S,function(){return this}),T(Pt,"toString",function(){return"[object Generator]"}),c.keys=function(b){var g=[];for(var D in b)g.push(D);return g.reverse(),function I(){for(;g.length;){var U=g.pop();if(U in b)return I.value=U,I.done=!1,I}return I.done=!0,I}},c.values=kt,Jt.prototype={constructor:Jt,reset:function(g){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Qt),!g)for(var D in this)D.charAt(0)==="t"&&l.call(this,D)&&!isNaN(+D.slice(1))&&(this[D]=void 0)},stop:function(){this.done=!0;var g=this.tryEntries[0].completion;if(g.type==="throw")throw g.arg;return this.rval},dispatchException:function(g){if(this.done)throw g;var D=this;function I(se,we){return ve.type="throw",ve.arg=g,D.next=se,we&&(D.method="next",D.arg=void 0),!!we}for(var U=this.tryEntries.length-1;U>=0;--U){var Z=this.tryEntries[U],ve=Z.completion;if(Z.tryLoc==="root")return I("end");if(Z.tryLoc<=this.prev){var ut=l.call(Z,"catchLoc"),ht=l.call(Z,"finallyLoc");if(ut&&ht){if(this.prev<Z.catchLoc)return I(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return I(Z.finallyLoc)}else if(ut){if(this.prev<Z.catchLoc)return I(Z.catchLoc,!0)}else{if(!ht)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return I(Z.finallyLoc)}}}},abrupt:function(g,D){for(var I=this.tryEntries.length-1;I>=0;--I){var U=this.tryEntries[I];if(U.tryLoc<=this.prev&&l.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var Z=U;break}}Z&&(g==="break"||g==="continue")&&Z.tryLoc<=D&&D<=Z.finallyLoc&&(Z=null);var ve=Z?Z.completion:{};return ve.type=g,ve.arg=D,Z?(this.method="next",this.next=Z.finallyLoc,te):this.complete(ve)},complete:function(g,D){if(g.type==="throw")throw g.arg;return g.type==="break"||g.type==="continue"?this.next=g.arg:g.type==="return"?(this.rval=this.arg=g.arg,this.method="return",this.next="end"):g.type==="normal"&&D&&(this.next=D),te},finish:function(g){for(var D=this.tryEntries.length-1;D>=0;--D){var I=this.tryEntries[D];if(I.finallyLoc===g)return this.complete(I.completion,I.afterLoc),Qt(I),te}},catch:function(g){for(var D=this.tryEntries.length-1;D>=0;--D){var I=this.tryEntries[D];if(I.tryLoc===g){var U=I.completion;if(U.type==="throw"){var Z=U.arg;Qt(I)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(g,D,I){return this.delegate={iterator:kt(g),resultName:D,nextLoc:I},this.method==="next"&&(this.arg=void 0),te}},c}var Gn=function(){return window&&window.strapi&&window.strapi.isEE?n(26789).Z:n(73871).Z}(),Vn=function(){return window&&window.strapi&&window.strapi.isEE?n(64527).Z:n(85302).Z}(),Zn=[{Component:function(){return{default:Vn}},to:"/settings/roles",exact:!0},{Component:function(){return{default:Gn}},to:"/settings/roles/duplicate/:id",exact:!0},{Component:function(){return{default:Gn}},to:"/settings/roles/new",exact:!0},{Component:function(){var c=(0,Ct.Z)(Oe().mark(function l(){var f;return Oe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,n.e(2544).then(n.bind(n,92100));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function u(){return c.apply(this,arguments)}return u}(),to:"/settings/roles/:id",exact:!0},{Component:function(){var c=(0,Ct.Z)(Oe().mark(function l(){var f;return Oe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,n.e(5199).then(n.bind(n,46903));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function u(){return c.apply(this,arguments)}return u}(),to:"/settings/users",exact:!0},{Component:function(){var c=(0,Ct.Z)(Oe().mark(function l(){var f;return Oe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,n.e(4263).then(n.bind(n,22282));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function u(){return c.apply(this,arguments)}return u}(),to:"/settings/users/:id",exact:!0},{Component:function(){var c=(0,Ct.Z)(Oe().mark(function l(){var f;return Oe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Promise.all([n.e(4675),n.e(5162)]).then(n.bind(n,3672));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function u(){return c.apply(this,arguments)}return u}(),to:"/settings/webhooks/create",exact:!0},{Component:function(){var c=(0,Ct.Z)(Oe().mark(function l(){var f;return Oe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,Promise.all([n.e(4675),n.e(5162)]).then(n.bind(n,42122));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function u(){return c.apply(this,arguments)}return u}(),to:"/settings/webhooks/:id",exact:!0},{Component:function(){var c=(0,Ct.Z)(Oe().mark(function l(){var f;return Oe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,n.e(4121).then(n.bind(n,6784));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function u(){return c.apply(this,arguments)}return u}(),to:"/settings/webhooks",exact:!0},{Component:function(){var c=(0,Ct.Z)(Oe().mark(function l(){var f;return Oe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,n.e(8056).then(n.bind(n,48601));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function u(){return c.apply(this,arguments)}return u}(),to:"/settings/api-tokens",exact:!0},{Component:function(){var c=(0,Ct.Z)(Oe().mark(function l(){var f;return Oe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,n.e(4299).then(n.bind(n,9683));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function u(){return c.apply(this,arguments)}return u}(),to:"/settings/api-tokens/create",exact:!0},{Component:function(){var c=(0,Ct.Z)(Oe().mark(function l(){var f;return Oe().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,n.e(92).then(n.bind(n,28465));case 2:return f=p.sent,p.abrupt("return",f);case 4:case"end":return p.stop()}},l)}));function u(){return c.apply(this,arguments)}return u}(),to:"/settings/api-tokens/:id",exact:!0}];const zn=Zn;var yn=function(){return window&&window.strapi&&window.strapi.isEE?n(5420).Z:n(35301).Z}();const Kn=[].concat((0,fn.Z)(yn),(0,fn.Z)(zn));var Mt=n(37909),vn=Object.defineProperty,Hn=Object.defineProperties,Xn=Object.getOwnPropertyDescriptors,Cn=Object.getOwnPropertySymbols,Ht=Object.prototype.hasOwnProperty,Yn=Object.prototype.propertyIsEnumerable,Xt=(c,u,l)=>u in c?vn(c,u,{enumerable:!0,configurable:!0,writable:!0,value:l}):c[u]=l,Yt=(c,u)=>{for(var l in u||(u={}))Ht.call(u,l)&&Xt(c,l,u[l]);if(Cn)for(var l of Cn(u))Yn.call(u,l)&&Xt(c,l,u[l]);return c},En=(c,u)=>Hn(c,Xn(u));const bn=({menu:c})=>{const{formatMessage:u}=(0,j.useIntl)(),f=Un(c).map(p=>En(Yt({},p),{title:p.intlLabel,links:p.links.map(F=>En(Yt({},F),{title:F.intlLabel,name:F.id}))})),S=u({id:"global.settings",defaultMessage:"Settings"});return e.createElement(Mt.SubNav,{ariaLabel:S},e.createElement(Mt.SubNavHeader,{label:S}),e.createElement(Mt.SubNavSections,null,f.map(p=>e.createElement(Mt.SubNavSection,{key:p.id,label:u(p.intlLabel)},p.links.map(F=>e.createElement(Mt.SubNavLink,{as:s.NavLink,withBullet:F.hasNotification,to:F.to,key:F.id},u(F.intlLabel)))))))};bn.propTypes={menu:E().array.isRequired};const Qn=bn;function Sn(){const{settingId:c}=(0,s.useParams)(),{settings:u}=(0,v.useStrapiApp)(),{formatMessage:l}=(0,j.useIntl)(),{isLoading:f,menu:S}=(0,le.Te)(),p=(0,e.useMemo)(()=>(0,ce.WW)(Kn.map(({to:C,Component:x,exact:te})=>(0,ce.ot)(x,C,te))),[]),F=Wn(u);if(f)return e.createElement(v.LoadingIndicatorPage,null);if(!c)return e.createElement(s.Redirect,{to:"/settings/application-infos"});const T=l({id:"global.settings",defaultMessage:"Settings"});return e.createElement(z.Layout,{sideNav:e.createElement(Qn,{menu:S})},e.createElement(ie.Helmet,{title:T}),e.createElement(s.Switch,null,e.createElement(s.Route,{path:"/settings/application-infos",component:Eo,exact:!0}),p,F))}const Jn=(0,e.memo)(Sn)},73871:(q,L,n)=>{"use strict";n.d(L,{Z:()=>z});var e=n(67294),v=n(49656);const z=()=>e.createElement(v.Redirect,{to:"/404"})},79578:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!0},35820:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!0},28472:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!0},56195:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!0},99047:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!0},21568:(q,L,n)=>{"use strict";n.d(L,{Z:()=>_a});var e=n(67294),v=n(45697),s=n.n(v),z=n(68547),j=n(11402),ie=n(18721),le=n.n(ie),ce=n(41609),Me=n.n(ce),_=n(97132),B=n(5493),R=n(78384),Q=n(89734),Pe=n.n(Q),X=n(70885),de=n(11132),dt=n.n(de),it=n(64763),tt=n.n(it),Ie=n(59522),ne=n(67826),E=n(27361),Te=n.n(E),nt=n(57557),Xe=n.n(nt),ye=n(59942),fe=n(70736),Re=n.n(fe),Ye=n(19408);const lt=R.default.div`
  position: relative;

  ${({hasConditions:a,disabled:t,theme:o})=>a&&`
    &:before {
      content: '';
      position: absolute;
      top: -3px;
      left: -10px;
      width: 6px;
      height: 6px;
      border-radius: ${20/16}rem;;
      background: ${t?o.colors.neutral100:o.colors.primary600};
    }
  `}
`,pt=({onClick:a,className:t,hasConditions:o,variant:r})=>{const{formatMessage:i}=(0,_.useIntl)();return e.createElement(lt,{hasConditions:o,className:t},e.createElement(Ye.Button,{variant:r,startIcon:e.createElement(Re(),null),onClick:a},i({id:"global.settings",defaultMessage:"Settings"})))};pt.defaultProps={className:null,hasConditions:!1,variant:"tertiary"},pt.propTypes={onClick:s().func.isRequired,className:s().string,hasConditions:s().bool,variant:s().string};const Qe=(0,R.default)(pt)``;var je=n(14276),ot=n(9008),Ee=n(75146),mt=n(68115),w=n(49425),Y=n(73749),V=n(7739),pe=n.n(V),Ae=n(11700),K=n.n(Ae),re=n(4942),he=n(42982),J=n(43808);const be=`${120/16}rem`,$e=`${200/16}rem`,at=`${53/16}rem`;function rt(a,t){var o=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(a,i).enumerable})),o.push.apply(o,r)}return o}function Et(a){for(var t=1;t<arguments.length;t++){var o=arguments[t]!=null?arguments[t]:{};t%2?rt(Object(o),!0).forEach(function(r){(0,re.Z)(a,r,o[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(o)):rt(Object(o)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(o,r))})}return a}var gt=function(){return window&&window.strapi&&window.strapi.isEE?n(53273).Z:n(79578).Z}(),W=(0,R.default)(ne.Flex).withConfig({displayName:"ActionRow__FlexWrapper",componentId:"sc-1bqpgdl-0"})(["height:",";"],at),ee=function(t){var o=t.arrayOfOptionsGroupedByCategory,r=t.isFormDisabled,i=t.isGrey,d=t.label,m=t.name,h=t.onChange,P=t.value,A=(0,_.useIntl)(),O=A.formatMessage,N=o.reduce(function($,G){var M=(0,X.Z)(G,2),k=M[0],ae=M[1],Ce={label:K()(k),children:ae.map(function(Ne){return{label:Ne.displayName,value:Ne.id}})};return[].concat((0,he.Z)($),[Ce])},[]),H=Object.values(P).map(function($){return Object.entries($).filter(function(G){var M=(0,X.Z)(G,2),k=M[1];return k}).map(function(G){var M=(0,X.Z)(G,1),k=M[0];return k})}).flat(),me=function(G){var M=(0,X.Z)(o,1),k=(0,X.Z)(M[0],2),ae=k[1],Ce=ae.reduce(function(Ne,Le){return Et((0,re.Z)({},Le.id,G.includes(Le.id)),Ne)},{});h(m,Ce)};return e.createElement(W,{as:"li",background:i?"neutral100":"neutral0"},e.createElement(ne.Flex,{paddingLeft:6,style:{width:180}},e.createElement(w.Typography,{variant:"sigma",textColor:"neutral600"},O({id:"Settings.permissions.conditions.can",defaultMessage:"Can"}),"\xA0"),e.createElement(w.Typography,{variant:"sigma",title:d,textColor:"primary600",ellipsis:!0},O({id:"Settings.roles.form.permissions.".concat(d.toLowerCase()),defaultMessage:d})),e.createElement(w.Typography,{variant:"sigma",textColor:"neutral600"},"\xA0",O({id:"Settings.permissions.conditions.when",defaultMessage:"When"}))),e.createElement(B.Box,{style:{maxWidth:430,width:"100%"}},e.createElement(J.MultiSelectNested,{id:m,customizeContent:function(G){return"".concat(G.length," currently selected")},onChange:me,value:H,options:N,disabled:r||gt})))};ee.propTypes={arrayOfOptionsGroupedByCategory:s().array.isRequired,isFormDisabled:s().bool.isRequired,isGrey:s().bool.isRequired,label:s().string.isRequired,name:s().string.isRequired,value:s().object.isRequired,onChange:s().func.isRequired};const oe=ee;var y=n(96486);const Ve=(a,t)=>a.reduce((o,r)=>(o[r.id]=(0,y.get)(t,r.id,!1),o),{}),ft=(a,t)=>a.reduce((o,r)=>{const[i,d]=r,m=Ve(d,t);return o[i]=m,o},{}),ue=(a,t,o)=>a.reduce((r,i)=>{const d=(0,y.get)(t,[...i.pathToConditionsObject,"conditions"],{}),m=ft(o,d);return r[i.pathToConditionsObject.join("..")]=m,r},{});var De=Object.defineProperty,Fe=Object.getOwnPropertySymbols,Rn=Object.prototype.hasOwnProperty,Dn=Object.prototype.propertyIsEnumerable,Ln=(a,t,o)=>t in a?De(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,tn=(a,t)=>{for(var o in t||(t={}))Rn.call(t,o)&&Ln(a,o,t[o]);if(Fe)for(var o of Fe(t))Dn.call(t,o)&&Ln(a,o,t[o]);return a};const nn=({actions:a,headerBreadCrumbs:t,isFormDisabled:o,onClosed:r,onToggle:i})=>{const{formatMessage:d}=(0,_.useIntl)(),{availableConditions:m,modifiedData:h,onChangeConditions:P}=(0,ye.$_)(),A=(0,e.useMemo)(()=>Object.entries(pe()(m,"category")),[m]),O=a.filter(({isDisplayed:M,hasSomeActionsSelected:k,hasAllActionsSelected:ae})=>M&&(k||ae)),N=(0,e.useMemo)(()=>ue(O,h,A),[O,h,A]),[H,me]=(0,e.useState)(N),$=(M,k)=>{me((0,Y.default)(ae=>{ae[M]||(ae[M]={}),ae[M].default||(ae[M].default={}),ae[M].default=k}))},G=()=>{const M=Object.entries(H).reduce((k,ae)=>{const[Ce,Ne]=ae,Le=Object.values(Ne).reduce((ke,ze)=>tn(tn({},ke),ze),{});return k[Ce]=Le,k},{});P(M),i()};return e.createElement(Ee.ModalLayout,{labelledBy:"condition-modal-breadcrumbs",onClose:r},e.createElement(Ee.ModalHeader,null,e.createElement(mt.Breadcrumbs,{id:"condition-modal-breadcrumbs",label:t.join(", ")},t.map(M=>e.createElement(mt.Crumb,{key:M},K()(d({id:M,defaultMessage:M})))))),e.createElement(B.Box,{padding:8},e.createElement(ot.Stack,{spacing:6},e.createElement(w.Typography,{variant:"beta",as:"h2"},d({id:"Settings.permissions.conditions.define-conditions",defaultMessage:"Define conditions"})),e.createElement(B.Box,null,e.createElement(je.Divider,null)),e.createElement(B.Box,null,O.length===0&&e.createElement(w.Typography,null,d({id:"Settings.permissions.conditions.no-actions",defaultMessage:"You first need to select actions (create, read, update, ...) before defining conditions on them."})),e.createElement("ul",null,O.map(({actionId:M,label:k,pathToConditionsObject:ae},Ce)=>{const Ne=ae.join("..");return e.createElement(oe,{key:M,arrayOfOptionsGroupedByCategory:A,label:k,isFormDisabled:o,isGrey:Ce%2===0,name:Ne,onChange:$,value:Te()(H,Ne,{})})}))))),e.createElement(Ee.ModalFooter,{startActions:e.createElement(Ye.Button,{variant:"tertiary",onClick:i},d({id:"app.components.Button.cancel",defaultMessage:"Cancel"})),endActions:e.createElement(Ye.Button,{onClick:G},d({id:"Settings.permissions.conditions.apply",defaultMessage:"Apply"}))}))};nn.propTypes={actions:s().arrayOf(s().shape({actionId:s().string.isRequired,checkboxName:s().string,hasSomeActionsSelected:s().bool.isRequired,hasAllActionsSelected:s().bool,isDisplayed:s().bool.isRequired,label:s().string})).isRequired,headerBreadCrumbs:s().arrayOf(s().string).isRequired,isFormDisabled:s().bool.isRequired,onClosed:s().func.isRequired,onToggle:s().func.isRequired};const Bt=nn,Ot=R.default.div`
  width: ${be};
`,vt=(0,R.default)(ne.Flex)`
  padding-right: ${({theme:a})=>a.spaces[2]};
  overflow: hidden;
  flex: 1;
  ${({isCollapsable:a})=>a&&"cursor: pointer;"}
`;var on=Object.defineProperty,an=Object.getOwnPropertySymbols,Ut=Object.prototype.hasOwnProperty,uo=Object.prototype.propertyIsEnumerable,xn=(a,t,o)=>t in a?on(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Mn=(a,t)=>{for(var o in t||(t={}))Ut.call(t,o)&&xn(a,o,t[o]);if(an)for(var o of an(t))uo.call(t,o)&&xn(a,o,t[o]);return a};const Rt=({children:a,isCollapsable:t,isActive:o,isFormDisabled:r,label:i,onChange:d,onClick:m,checkboxName:h,someChecked:P,value:A})=>{const{formatMessage:O}=(0,_.useIntl)();return e.createElement(ne.Flex,{alignItems:"center",paddingLeft:6,style:{width:$e,flexShrink:0}},e.createElement(B.Box,{paddingRight:2},e.createElement(Ie.BaseCheckbox,{name:h,"aria-label":O({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:i}),disabled:r,onValueChange:N=>d({target:{name:h,value:N}}),indeterminate:P,value:A})),e.createElement(vt,Mn({title:i,alignItems:"center",isCollapsable:t},t&&{onClick:m,"aria-expanded":o,onKeyDown:({key:N})=>(N==="Enter"||N===" ")&&m(),tabIndex:0,role:"button"}),e.createElement(w.Typography,{fontWeight:o?"bold":"",textColor:o?"primary600":"neutral800",ellipsis:!0},K()(i)),a))};Rt.defaultProps={children:null,checkboxName:"",onChange:()=>{},value:!1,someChecked:!1,isCollapsable:!1},Rt.propTypes={checkboxName:s().string,children:s().node,label:s().string.isRequired,isCollapsable:s().bool,isFormDisabled:s().bool.isRequired,onChange:s().func,onClick:s().func.isRequired,someChecked:s().bool,value:s().bool,isActive:s().bool.isRequired};const rn=(0,e.memo)(Rt),jt=a=>(0,y.isObject)(a)?(0,y.flattenDeep)(Object.values(a).map(t=>(0,y.isObject)(t)?jt(t):t)):[],Dt=jt,Gt=a=>a?Object.keys(a).reduce((t,o)=>(o!=="conditions"&&(t[o]=a[o]),t),{}):null,St=a=>{const t=Gt(a),o=Dt(t);if(!o.length)return{hasAllActionsSelected:!1,hasSomeActionsSelected:!1};const r=o.every(d=>d),i=o.some(d=>d)&&!r;return{hasAllActionsSelected:r,hasSomeActionsSelected:i}},Vt=(a,t,o)=>a.map(({actionId:r,isDisplayed:i,applyToProperties:d,label:m})=>{if(!i)return{actionId:r,hasSomeActionsSelected:!1,isDisplayed:i};const h=[...o.split(".."),r],P=(0,y.isEmpty)(d)?[...h,"properties","enabled"]:h,A=P.join(".."),O=(0,y.get)(t,[...h,"conditions"],null),N=Dt(O).some(G=>G);if((0,y.isEmpty)(d)){const G=(0,y.get)(t,P,!1);return{actionId:r,checkboxName:A,hasAllActionsSelected:G,hasConditions:N,hasSomeActionsSelected:G,isDisplayed:i,isParentCheckbox:!1,label:m,pathToConditionsObject:h}}const H=(0,y.get)(t,P,null),{hasAllActionsSelected:me,hasSomeActionsSelected:$}=St(H);return{actionId:r,checkboxName:A,hasAllActionsSelected:me,hasConditions:N,hasSomeActionsSelected:$,isDisplayed:i,isParentCheckbox:!0,label:m,pathToConditionsObject:h}});var In=n(99962),sn=n.n(In);const Lt=(0,R.default)(sn())`
  display: none;
  width: ${10/16}rem;
  transform: rotate(${({$isActive:a})=>a?"180":"0"}deg);
  margin-left: ${({theme:a})=>a.spaces[2]};
`,xt=a=>`
  ${w.Typography} {
    color: ${a.colors.primary600};
    font-weight: ${a.fontWeights.bold}
  }
  ${Lt} {
    display: block;
    path {
      fill: ${a.colors.primary600}
    };
  }
`;var ln=function(){return window&&window.strapi&&window.strapi.isEE?n(20591).Z:n(56195).Z}(),Zt=function a(t,o){return`
  `.concat(cn,` {
    background-color: `).concat(t.colors.primary100,`;
    color: `).concat(t.colors.primary600,`;
    border-radius: `).concat(o?"2px 2px 0 0":"2px",`;
  }
  `).concat(un,` {
    display: flex;
  }
  `).concat(Qe,` {
    display: block;
  }
  &:hover {
   `).concat(xt(t),`
  }

  &:focus-within {
    `).concat(function(r){var i=r.theme,d=r.isActive;return a(i,d)},`
  }
  
`)},cn=R.default.div.withConfig({displayName:"Collapse__Wrapper",componentId:"sc-132fji1-0"})(["flex:1;display:flex;align-items:center;height:",";background-color:",";border:1px solid transparent;"],at,function(a){var t=a.isGrey,o=a.theme;return t?o.colors.neutral100:o.colors.neutral0}),Fn=R.default.div.withConfig({displayName:"Collapse__BoxWrapper",componentId:"sc-132fji1-1"})(["display:inline-flex;min-width:100%;","{display:none;}"," &:hover{","}"],Qe,function(a){var t=a.isActive,o=a.theme;return t&&Zt(o,t)},function(a){var t=a.theme,o=a.isActive;return Zt(t,o)}),zt=(0,R.default)(ne.Flex).withConfig({displayName:"Collapse__Cell",componentId:"sc-132fji1-2"})(["width:",";position:relative;"],be),un=(0,R.default)(B.Box).withConfig({displayName:"Collapse__Chevron",componentId:"sc-132fji1-3"})(["display:none;svg{width:11px;}*{fill:",";}"],function(a){var t=a.theme;return t.colors.primary600}),dn=R.default.span.withConfig({displayName:"Collapse__TinyDot",componentId:"sc-132fji1-4"})(["position:absolute;top:-6px;left:37px;width:6px;height:6px;border-radius:20px;background:",";"],function(a){var t=a.theme;return t.colors.primary600}),yo=(0,R.default)(B.Box).withConfig({displayName:"Collapse__AbsoluteBox",componentId:"sc-132fji1-5"})(["position:absolute;right:9px;transform:translateY(10px);"]),Kt=function(t){var o=t.availableActions,r=t.isActive,i=t.isGrey,d=t.isFormDisabled,m=t.label,h=t.onClickToggle,P=t.pathToData,A=(0,e.useState)(!1),O=(0,X.Z)(A,2),N=O[0],H=O[1],me=(0,_.useIntl)(),$=me.formatMessage,G=(0,ye.$_)(),M=G.modifiedData,k=G.onChangeParentCheckbox,ae=G.onChangeSimpleCheckbox,Ce=function(){H(function(Be){return!Be})},Ne=function(){H(!1)},Le=Te()(M,P.split(".."),{}),ke=(0,e.useMemo)(function(){return Object.keys(Le).reduce(function(Se,Be){return Se[Be]=Xe()(Le[Be],"conditions"),Se},{})},[Le]),ze=St(ke),Ge=ze.hasAllActionsSelected,Ft=ze.hasSomeActionsSelected,xe=(0,e.useMemo)(function(){return Vt(o,M,P)},[o,M,P]),Ke=xe.some(function(Se){var Be=Se.hasConditions;return Be});return e.createElement(Fn,{isActive:r},e.createElement(cn,{isGrey:i},e.createElement(rn,{isCollapsable:!0,isFormDisabled:d,label:m,checkboxName:P,onChange:k,onClick:h,someChecked:Ft,value:Ge,isActive:r},e.createElement(un,{paddingLeft:2},r?e.createElement(tt(),null):e.createElement(dt(),null))),e.createElement(ne.Flex,{style:{flex:1}},xe.map(function(Se){var Be=Se.actionId,We=Se.hasConditions,He=Se.hasAllActionsSelected,et=Se.hasSomeActionsSelected,At=Se.isDisplayed,st=Se.isParentCheckbox,bt=Se.checkboxName,Wt=Se.label;return At?st?e.createElement(zt,{key:Be,justifyContent:"center",alignItems:"center"},We&&e.createElement(dn,null),e.createElement(Ie.BaseCheckbox,{disabled:d||ln,name:bt,"aria-label":$({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(Wt," ").concat(m)}),onValueChange:function(wt){k({target:{name:bt,value:wt}})},indeterminate:et,value:He})):e.createElement(zt,{key:Be,justifyContent:"center",alignItems:"center"},We&&e.createElement(dn,null),e.createElement(Ie.BaseCheckbox,{disabled:d||ln,indeterminate:We,name:bt,onValueChange:function(wt){ae({target:{name:bt,value:wt}})},value:He})):e.createElement(Ot,{key:Be})})),N&&e.createElement(Bt,{headerBreadCrumbs:[m,"app.components.LeftMenuLinkContainer.settings"],actions:xe,isFormDisabled:d,onClosed:Ne,onToggle:Ce})),e.createElement(yo,null,e.createElement(Qe,{onClick:Ce,hasConditions:Ke})))};Kt.propTypes={availableActions:s().array.isRequired,isActive:s().bool.isRequired,isGrey:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggle:s().func.isRequired,pathToData:s().string.isRequired};const pn=Kt,wn=(a,t)=>a.map(o=>{const r=Array.isArray(o.applyToProperties)&&o.applyToProperties.indexOf(t)!==-1&&o.isDisplayed;return{label:o.label,actionId:o.actionId,isActionRelatedToCurrentProperty:r}}),Bn=(0,R.default)(ne.Flex)`
  width: ${be};
  flex-shrink: 0;
`,jn=(0,R.default)(ne.Flex)`
  width: ${$e};
  height: ${at};
  flex-shrink: 0;
`,mn=({headers:a,label:t})=>{const{formatMessage:o}=(0,_.useIntl)(),r=o({id:"Settings.roles.form.permission.property-label",defaultMessage:"{label} permissions"},{label:t});return e.createElement(ne.Flex,null,e.createElement(jn,{alignItems:"center",paddingLeft:6},e.createElement(w.Typography,{variant:"sigma",textColor:"neutral500"},r)),a.map(i=>i.isActionRelatedToCurrentProperty?e.createElement(Bn,{justifyContent:"center",key:i.label},e.createElement(w.Typography,{variant:"sigma",textColor:"neutral500"},o({id:`Settings.roles.form.permissions.${i.label.toLowerCase()}`,defaultMessage:i.label}))):e.createElement(Bn,{key:i.label})))};mn.propTypes={headers:s().arrayOf(s().shape({label:s().string.isRequired,isActionRelatedToCurrentProperty:s().bool.isRequired})).isRequired,label:s().string.isRequired};const Nn=mn,Co=R.default.span`
  color: ${({theme:a})=>a.colors.danger700};
  padding-left: ${({theme:a})=>a.spaces[1]}px;
`,gn=()=>e.createElement(Co,null,"*");var kn=Object.defineProperty,bo=Object.defineProperties,Wn=Object.getOwnPropertyDescriptors,$n=Object.getOwnPropertySymbols,Un=Object.prototype.hasOwnProperty,fn=Object.prototype.propertyIsEnumerable,hn=(a,t,o)=>t in a?kn(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Ct=(a,t)=>{for(var o in t||(t={}))Un.call(t,o)&&hn(a,o,t[o]);if($n)for(var o of $n(t))fn.call(t,o)&&hn(a,o,t[o]);return a},Oe=(a,t)=>bo(a,Wn(t));const Vn=(a,t)=>a.map(o=>{const r=Array.isArray(o.subjects)&&o.subjects.indexOf(t)!==-1;return Oe(Ct({},o),{isDisplayed:r})});var Zn=n(87462),zn=Object.defineProperty,yn=Object.getOwnPropertySymbols,Kn=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable,vn=(a,t,o)=>t in a?zn(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Hn=(a,t)=>{for(var o in t||(t={}))Kn.call(t,o)&&vn(a,o,t[o]);if(yn)for(var o of yn(t))Mt.call(t,o)&&vn(a,o,t[o]);return a};const Xn=(0,R.default)(B.Box)`
  transform: translate(-4px, -12px);

  &:before {
    content: '';
    width: ${4/16}rem;
    height: ${12/16}rem;
    background: ${({theme:a})=>a.colors.primary200};
    display: block;
  }
`,Cn=R.default.svg`
  position: relative;
  flex-shrink: 0;
  transform: translate(-0.5px, -1px);

  * {
    fill: ${({theme:a,color:t})=>a.colors[t]};
  }
`,Ht=a=>e.createElement(Xn,null,e.createElement(Cn,Hn({width:"20",height:"23",viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a),e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.02477 14.7513C8.65865 17.0594 11.6046 18.6059 17.5596 18.8856C18.6836 18.9384 19.5976 19.8435 19.5976 20.9688V20.9688C19.5976 22.0941 18.6841 23.0125 17.5599 22.9643C10.9409 22.6805 6.454 20.9387 3.75496 17.1258C0.937988 13.1464 0.486328 7.39309 0.486328 0.593262H4.50974C4.50974 7.54693 5.06394 11.9813 7.02477 14.7513Z",fill:"#D9D8FF"})));Ht.defaultProps={fill:"primary200"},Ht.propTypes={fill:s().string};const Yn=(0,e.memo)(Ht);var Xt=function(){return window&&window.strapi&&window.strapi.isEE?n(76766).Z:n(28472).Z}(),Yt=(0,R.default)(ne.Flex).withConfig({displayName:"SubActionRow__Cell",componentId:"sc-7y8yzq-0"})(["width:",";position:relative;"],be),En=(0,R.default)(ne.Flex).withConfig({displayName:"SubActionRow__RowWrapper",componentId:"sc-7y8yzq-1"})(["height:",";"],at),bn=(0,R.default)(B.Box).withConfig({displayName:"SubActionRow__Wrapper",componentId:"sc-7y8yzq-2"})(["padding-left:","rem;"],31/16),Qn=(0,R.default)(B.Box).withConfig({displayName:"SubActionRow__LeftBorderTimeline",componentId:"sc-7y8yzq-3"})(["border-left:",";"],function(a){var t=a.isVisible,o=a.theme;return t?"4px solid ".concat(o.colors.primary200):"4px solid transparent"}),Sn=(0,R.default)(ne.Flex).withConfig({displayName:"SubActionRow__RowStyle",componentId:"sc-7y8yzq-4"})(["padding-left:",";width:","px;"," ",";"],function(a){var t=a.theme;return t.spaces[4]},function(a){var t=a.level;return 145-t*36},function(a){var t=a.isCollapsable,o=a.theme;return t&&`
      `.concat(Lt,` {
        display: block;
        color: `).concat(o.colors.neutral100,`;
      }
      &:hover {
        `).concat(xt(o),`
      }
  `)},function(a){var t=a.isActive,o=a.theme;return t&&xt(o)}),Jn=R.default.div.withConfig({displayName:"SubActionRow__TopTimeline",componentId:"sc-7y8yzq-5"})(["padding-top:",";margin-top:",";width:","rem;background-color:",";border-top-left-radius:2px;border-top-right-radius:2px;"],function(a){var t=a.theme;return t.spaces[2]},function(a){var t=a.theme;return t.spaces[2]},4/16,function(a){var t=a.theme;return t.colors.primary200}),c=function a(t){var o=t.childrenForm,r=t.isFormDisabled,i=t.recursiveLevel,d=t.pathToDataFromActionRow,m=t.propertyActions,h=t.parentName,P=t.propertyName,A=(0,_.useIntl)(),O=A.formatMessage,N=(0,ye.$_)(),H=N.modifiedData,me=N.onChangeParentCheckbox,$=N.onChangeSimpleCheckbox,G=(0,e.useState)(null),M=(0,X.Z)(G,2),k=M[0],ae=M[1],Ce=function(ke){ae(function(ze){return ze===ke?null:ke})},Ne=(0,e.useMemo)(function(){return k?o.find(function(Le){var ke=Le.value;return ke===k}):null},[k,o]);return e.createElement(bn,null,e.createElement(Jn,null),o.map(function(Le,ke){var ze=Le.label,Ge=Le.value,Ft=Le.required,xe=Le.children,Ke=ke+1<o.length,Se=Array.isArray(xe),Be=k===Ge;return e.createElement(Qn,{key:Ge,isVisible:Ke},e.createElement(En,null,e.createElement(Yn,{color:"primary200"}),e.createElement(ne.Flex,{style:{flex:1}},e.createElement(Sn,{level:i,isActive:Be,isCollapsable:Se},e.createElement(vt,(0,Zn.Z)({alignItems:"center",isCollapsable:Se},Se&&{onClick:function(){return Ce(Ge)},"aria-expanded":Be,onKeyDown:function(He){var et=He.key;return(et==="Enter"||et===" ")&&Ce(Ge)},tabIndex:0,role:"button"},{title:ze}),e.createElement(w.Typography,{ellipsis:!0},K()(ze)),Ft&&e.createElement(gn,null),e.createElement(Lt,{$isActive:Be}))),e.createElement(ne.Flex,{style:{flex:1}},m.map(function(We){var He=We.actionId,et=We.label,At=We.isActionRelatedToCurrentProperty;if(!At)return e.createElement(Ot,{key:He});var st=[].concat((0,he.Z)(d.split("..")),[He,"properties",P],(0,he.Z)(h.split("..")),[Ge]),bt=Te()(H,st,!1);if(!xe)return e.createElement(Yt,{key:et,justifyContent:"center",alignItems:"center"},e.createElement(Ie.BaseCheckbox,{disabled:r||Xt,name:st.join(".."),"aria-label":O({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(ze," ").concat(et)}),onValueChange:function(en){$({target:{name:st.join(".."),value:en}})},value:bt}));var Wt=St(bt),$t=Wt.hasAllActionsSelected,wt=Wt.hasSomeActionsSelected;return e.createElement(Yt,{key:et,justifyContent:"center",alignItems:"center"},e.createElement(Ie.BaseCheckbox,{key:et,disabled:r||Xt,name:st.join(".."),"aria-label":O({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(h," ").concat(ze," ").concat(et)}),onValueChange:function(en){me({target:{name:st.join(".."),value:en}})},value:$t,indeterminate:wt}))})))),Ne&&Be&&e.createElement(B.Box,{paddingBottom:2},e.createElement(a,{isFormDisabled:r,parentName:"".concat(h,"..").concat(Ge),pathToDataFromActionRow:d,propertyActions:m,propertyName:P,recursiveLevel:i+1,childrenForm:Ne.children})))}))};c.propTypes={childrenForm:s().array.isRequired,isFormDisabled:s().bool.isRequired,parentName:s().string.isRequired,pathToDataFromActionRow:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,recursiveLevel:s().number.isRequired};const u=(0,e.memo)(c),l=a=>a.reduce((o,r)=>(r.isActionRelatedToCurrentProperty&&o.push(r.actionId),o),[]),S=(a,t,o,r,i)=>{const m=l(a).reduce((h,P)=>{const A=[...o.split(".."),P,"properties",r,i],O=(0,y.get)(t,A,!1);return h[P]=O,h},{});return St(m)};var p=function(){return window&&window.strapi&&window.strapi.isEE?n(74512).Z:n(35820).Z}(),F=(0,R.default)(ne.Flex).withConfig({displayName:"ActionRow__Cell",componentId:"sc-4agenc-0"})(["width:",";position:relative;"],be),T=(0,R.default)(ne.Flex).withConfig({displayName:"ActionRow__Wrapper",componentId:"sc-4agenc-1"})(["height:",";flex:1;"," ",";"],at,function(a){var t=a.isCollapsable,o=a.theme;return t&&`
      `.concat(Lt,` {
        display: block;
        color: `).concat(o.colors.neutral100,`;
      }
      &:hover {
        `).concat(xt(o),`
      }
  `)},function(a){var t=a.isActive,o=a.theme;return t&&xt(o)}),C=function(t){var o=t.childrenForm,r=t.label,i=t.isFormDisabled,d=t.name,m=t.required,h=t.pathToData,P=t.propertyActions,A=t.propertyName,O=t.isOdd,N=(0,_.useIntl)(),H=N.formatMessage,me=(0,e.useState)(null),$=(0,X.Z)(me,2),G=$[0],M=$[1],k=(0,ye.$_)(),ae=k.modifiedData,Ce=k.onChangeCollectionTypeLeftActionRowCheckbox,Ne=k.onChangeParentCheckbox,Le=k.onChangeSimpleCheckbox,ke=G===d,ze=(0,e.useMemo)(function(){return Array.isArray(o)?o:[]},[o]),Ge=ze.length>0,Ft=(0,e.useCallback)(function(){Ge&&M(function(We){return We===d?null:d})},[Ge,d]),xe=function(He){var et=He.target.value;Ce(h,A,d,et)},Ke=(0,e.useMemo)(function(){return S(P,ae,h,A,d)},[P,ae,h,A,d]),Se=Ke.hasAllActionsSelected,Be=Ke.hasSomeActionsSelected;return e.createElement(e.Fragment,null,e.createElement(T,{alignItems:"center",isCollapsable:Ge,isActive:ke,background:O?"neutral100":"neutral0"},e.createElement(ne.Flex,null,e.createElement(rn,{onChange:xe,onClick:Ft,isCollapsable:Ge,isFormDisabled:i,label:r,someChecked:Be,value:Se,isActive:ke},m&&e.createElement(gn,null),e.createElement(Lt,{$isActive:ke})),e.createElement(ne.Flex,null,P.map(function(We){var He=We.label,et=We.isActionRelatedToCurrentProperty,At=We.actionId;if(!et)return e.createElement(Ot,{key:He});var st=[].concat((0,he.Z)(h.split("..")),[At,"properties",A,d]);if(!Ge){var bt=Te()(ae,st,!1);return e.createElement(F,{key:At,justifyContent:"center",alignItems:"center"},e.createElement(Ie.BaseCheckbox,{disabled:i||p,name:st.join(".."),"aria-label":H({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(d," ").concat(He)}),onValueChange:function(io){Le({target:{name:st.join(".."),value:io}})},value:bt}))}var Wt=Te()(ae,st,{}),$t=St(Wt),wt=$t.hasAllActionsSelected,so=$t.hasSomeActionsSelected;return e.createElement(F,{key:He,justifyContent:"center",alignItems:"center"},e.createElement(Ie.BaseCheckbox,{disabled:i||p,name:st.join(".."),onValueChange:function(io){Ne({target:{name:st.join(".."),value:io}})},"aria-label":H({id:"Settings.permissions.select-by-permission",defaultMessage:"Select {label} permission"},{label:"".concat(d," ").concat(He)}),value:wt,indeterminate:so}))})))),ke&&e.createElement(u,{childrenForm:ze,isFormDisabled:i,parentName:d,pathToDataFromActionRow:h,propertyName:A,propertyActions:P,recursiveLevel:0}))};C.defaultProps={childrenForm:[],required:!1},C.propTypes={childrenForm:s().array,label:s().string.isRequired,isFormDisabled:s().bool.isRequired,name:s().string.isRequired,pathToData:s().string.isRequired,propertyActions:s().array.isRequired,propertyName:s().string.isRequired,required:s().bool,isOdd:s().bool.isRequired};const x=(0,e.memo)(C),te=R.default.div`
  display: inline-flex;
  flex-direction: column;
  min-width: 0;
`,ge=({availableActions:a,childrenForm:t,isFormDisabled:o,label:r,pathToData:i,propertyName:d})=>{const m=(0,e.useMemo)(()=>wn(a,d),[a,d]);return e.createElement(te,null,e.createElement(Nn,{label:r,headers:m}),e.createElement(B.Box,null,t.map(({children:h,label:P,value:A,required:O},N)=>e.createElement(x,{childrenForm:h,key:A,label:P,isFormDisabled:o,name:A,required:O,propertyActions:m,pathToData:i,propertyName:d,isOdd:N%2===0}))))};ge.propTypes={childrenForm:s().array.isRequired,availableActions:s().array.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,pathToData:s().string.isRequired,propertyName:s().string.isRequired};const Ue=ge,Je=R.default.div`
  flex-direction: column;
  display: inline-flex;
  min-width: 100%;
  ${({theme:a,isActive:t})=>t&&`border: 1px solid ${a.colors.primary600};`}
`,qe=({allActions:a,contentTypeName:t,label:o,index:r,isActive:i,isFormDisabled:d,onClickToggleCollapse:m,pathToData:h,properties:P})=>{const A=(0,e.useCallback)(()=>{m(t)},[t,m]),O=(0,e.useMemo)(()=>Vn(a,t),[a,t]);return e.createElement(Je,{isActive:i},e.createElement(pn,{availableActions:O,isActive:i,isGrey:r%2===0,isFormDisabled:d,label:o,onClickToggle:A,pathToData:h}),i&&P.map(({label:N,value:H,children:me})=>e.createElement(Ue,{availableActions:O,childrenForm:me,isFormDisabled:d,label:N,pathToData:h,propertyName:H,key:H})))};qe.propTypes={allActions:s().array.isRequired,contentTypeName:s().string.isRequired,index:s().number.isRequired,isActive:s().bool.isRequired,isFormDisabled:s().bool.isRequired,label:s().string.isRequired,onClickToggleCollapse:s().func.isRequired,pathToData:s().string.isRequired,properties:s().array.isRequired};const _e=qe,Ze=({actions:a,isFormDisabled:t,pathToData:o,subjects:r})=>{const[i,d]=(0,e.useState)(null),m=h=>{d(i===h?null:h)};return r.map(({uid:h,label:P,properties:A},O)=>e.createElement(_e,{allActions:a,key:h,contentTypeName:h,label:P,isActive:i===h,isFormDisabled:t,index:O,onClickToggleCollapse:m,pathToData:`${o}..${h}`,properties:A}))};Ze.defaultProps={actions:[],subjects:[]},Ze.propTypes={actions:s().array.isRequired,isFormDisabled:s().bool.isRequired,pathToData:s().string.isRequired,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))};const Pt=(0,e.memo)(Ze),Nt=a=>a.filter(({subjects:t})=>t&&t.length);var Pn=Object.defineProperty,Tn=Object.getOwnPropertySymbols,Qt=Object.prototype.hasOwnProperty,Jt=Object.prototype.propertyIsEnumerable,kt=(a,t,o)=>t in a?Pn(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,qt=(a,t)=>{for(var o in t||(t={}))Qt.call(t,o)&&kt(a,o,t[o]);if(Tn)for(var o of Tn(t))Jt.call(t,o)&&kt(a,o,t[o]);return a};const b=a=>a.map(({actionId:t})=>t),g=(a,t)=>a.reduce((o,r)=>(Object.keys(t).forEach(i=>{const d=(0,y.get)(t,[i,r],{}),m={[i]:Gt(d)};o[r]?o[r]=qt(qt({},o[r]),m):o[r]=m}),o),{}),I=(a,t)=>{const o=b(a),r=g(o,t);return Object.keys(r).reduce((d,m)=>(d[m]=St(r[m]),d),{})};var U=function(){return window&&window.strapi&&window.strapi.isEE?n(85822).Z:n(99047).Z}(),Z=(0,R.default)(ot.Stack).withConfig({displayName:"GlobalActions__CenteredStack",componentId:"sc-1vxwsjr-0"})(["align-items:center;justify-content:center;width:",";flex-shrink:0;"],be),ve=function(t){var o=t.actions,r=t.isFormDisabled,i=t.kind,d=(0,_.useIntl)(),m=d.formatMessage,h=(0,ye.$_)(),P=h.modifiedData,A=h.onChangeCollectionTypeGlobalActionCheckbox,O=(0,e.useMemo)(function(){return Nt(o)},[o]),N=(0,e.useMemo)(function(){return I(O,P[i])},[P,O,i]);return e.createElement(B.Box,{paddingBottom:4,paddingTop:6,style:{paddingLeft:$e}},e.createElement(ot.Stack,{horizontal:!0,spacing:0},O.map(function(H){var me=H.label,$=H.actionId;return e.createElement(Z,{key:$,spacing:3},e.createElement(w.Typography,{variant:"sigma",textColor:"neutral500"},m({id:"Settings.roles.form.permissions.".concat(me.toLowerCase()),defaultMessage:me})),e.createElement(Ie.BaseCheckbox,{disabled:r||U,onValueChange:function(M){A(i,$,M)},name:$,"aria-label":m({id:"Settings.permissions.select-all-by-permission",defaultMessage:"Select all {label} permissions"},{label:m({id:"Settings.roles.form.permissions.".concat(me.toLowerCase()),defaultMessage:me})}),value:Te()(N,[$,"hasAllActionsSelected"],!1),indeterminate:Te()(N,[$,"hasSomeActionsSelected"],!1)}))})))};ve.defaultProps={actions:[]},ve.propTypes={actions:s().arrayOf(s().shape({label:s().string.isRequired,actionId:s().string.isRequired,subjects:s().array.isRequired})),isFormDisabled:s().bool.isRequired,kind:s().string.isRequired};const ut=(0,e.memo)(ve),ht=(0,R.default)(B.Box)`
  overflow-x: auto;
`,se=({isFormDisabled:a,kind:t,layout:{actions:o,subjects:r}})=>{const i=Pe()([...r],"label");return e.createElement(ht,{background:"neutral0"},e.createElement(ut,{actions:o,kind:t,isFormDisabled:a}),e.createElement(Pt,{actions:o,isFormDisabled:a,pathToData:t,subjects:i}))};se.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().shape({actions:s().array,subjects:s().arrayOf(s().shape({uid:s().string.isRequired,label:s().string.isRequired,properties:s().array.isRequired}))}).isRequired};const we=(0,e.memo)(se);var yt=n(47713);const _t=({children:a,value:t})=>e.createElement(yt.$l.Provider,{value:t},a);_t.propTypes={children:s().node.isRequired,value:s().exact({availableConditions:s().array.isRequired,modifiedData:s().object.isRequired,onChangeCollectionTypeLeftActionRowCheckbox:s().func.isRequired,onChangeConditions:s().func.isRequired,onChangeSimpleCheckbox:s().func.isRequired,onChangeParentCheckbox:s().func.isRequired,onChangeCollectionTypeGlobalActionCheckbox:s().func.isRequired}).isRequired};const An=_t;var It=n(96654),Tt=n(34626),So=n(81325),_o=Object.defineProperty,ea=Object.defineProperties,ta=Object.getOwnPropertyDescriptors,Po=Object.getOwnPropertySymbols,na=Object.prototype.hasOwnProperty,oa=Object.prototype.propertyIsEnumerable,To=(a,t,o)=>t in a?_o(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,aa=(a,t)=>{for(var o in t||(t={}))na.call(t,o)&&To(a,o,t[o]);if(Po)for(var o of Po(t))oa.call(t,o)&&To(a,o,t[o]);return a},ra=(a,t)=>ea(a,ta(t));const sa=(a,t,o)=>a.map(r=>{const i=[...o,r.action,"properties","enabled"],d=(0,y.get)(t,i,!1),m=(0,y.get)(t,[...o,r.action,"conditions"],{}),h=Dt(m).some(P=>P);return ra(aa({},r),{isDisplayed:d,checkboxName:i.join(".."),hasSomeActionsSelected:d,value:d,hasConditions:h,label:r.displayName,actionId:r.action,pathToConditionsObject:[...o,r.action]})}),ia=a=>{const t=Object.entries(a).reduce((r,i)=>{const[d,{conditions:m}]=i;return r[d]=m,r},{});return Dt(t).some(r=>r)};var _n=function(){return window&&window.strapi&&window.strapi.isEE?n(8629).Z:n(34341).Z}(),la=R.default.div.withConfig({displayName:"SubCategory__Border",componentId:"sc-akgczm-0"})(["flex:1;align-self:center;border-top:1px solid ",";"],function(a){var t=a.theme;return t.colors.neutral150}),ca=R.default.div.withConfig({displayName:"SubCategory__CheckboxWrapper",componentId:"sc-akgczm-1"})(["position:relative;word-break:keep-all;",""],function(a){var t=a.hasConditions,o=a.disabled,r=a.theme;return t&&`
    &:before {
      content: '';
      position: absolute;
      top: `.concat(-4/16,`rem;
      left: `).concat(-8/16,`rem;
      width: `).concat(6/16,`rem;
      height: `).concat(6/16,`rem;
      border-radius: `).concat(20/16,`rem;
      background: `).concat(o?r.colors.neutral100:r.colors.primary600,`;
    }
  `)}),Ao=function(t){var o=t.categoryName,r=t.isFormDisabled,i=t.subCategoryName,d=t.actions,m=t.pathToData,h=(0,e.useState)(!1),P=(0,X.Z)(h,2),A=P[0],O=P[1],N=(0,ye.$_)(),H=N.modifiedData,me=N.onChangeParentCheckbox,$=N.onChangeSimpleCheckbox,G=(0,_.useIntl)(),M=G.formatMessage,k=Te()(H,m,{}),ae=(0,e.useMemo)(function(){return Object.keys(k).reduce(function(xe,Ke){return xe[Ke]=Gt(k[Ke]),xe},{})},[k]),Ce=St(ae),Ne=Ce.hasAllActionsSelected,Le=Ce.hasSomeActionsSelected,ke=function(){O(function(Ke){return!Ke})},ze=function(){O(!1)},Ge=sa(d,H,m),Ft=ia(Te()(H,(0,he.Z)(m),{}));return e.createElement(e.Fragment,null,e.createElement(B.Box,null,e.createElement(ne.Flex,{justifyContent:"space-between",alignItems:"center"},e.createElement(B.Box,{paddingRight:4},e.createElement(w.Typography,{variant:"sigma",textColor:"neutral600"},i)),e.createElement(la,null),e.createElement(B.Box,{paddingLeft:4},e.createElement(So.Checkbox,{name:m.join(".."),disabled:r||_n,onValueChange:function(Ke){me({target:{name:m.join(".."),value:Ke}})},indeterminate:Le,value:Ne},M({id:"app.utils.select-all",defaultMessage:"Select all"})))),e.createElement(ne.Flex,{paddingTop:6,paddingBottom:6},e.createElement(Tt.Grid,{gap:2,style:{flex:1}},Ge.map(function(xe){var Ke=xe.checkboxName,Se=xe.value,Be=xe.action,We=xe.displayName,He=xe.hasConditions;return e.createElement(Tt.GridItem,{col:3,key:Be},e.createElement(ca,{disabled:r||_n,hasConditions:He},e.createElement(So.Checkbox,{name:Ke,disabled:r||_n,onValueChange:function(At){$({target:{name:Ke,value:At}})},value:Se},We)))})),e.createElement(Qe,{hasConditions:Ft,onClick:ke}))),A&&e.createElement(Bt,{headerBreadCrumbs:[o,i],actions:Ge,isFormDisabled:r,onClosed:ze,onToggle:ke}))};Ao.propTypes={actions:s().array.isRequired,categoryName:s().string.isRequired,isFormDisabled:s().bool.isRequired,subCategoryName:s().string.isRequired,pathToData:s().array.isRequired};const ua=Ao,eo=({childrenForm:a,kind:t,name:o,isOpen:r,isFormDisabled:i,isWhite:d,onOpenCategory:m,pathToData:h})=>{const{formatMessage:P}=(0,_.useIntl)(),A=()=>{m(o)},O=(0,e.useMemo)(()=>o.split("::").pop(),[o]);return e.createElement(It.Accordion,{expanded:r,onToggle:A,id:`accordion-${o}`,variant:d?"primary":"secondary"},e.createElement(It.AccordionToggle,{title:K()(O),description:`${P({id:"Settings.permissions.category"},{category:O})} ${t==="plugins"?"plugin":t}`}),e.createElement(It.AccordionContent,null,e.createElement(B.Box,{padding:6},a.map(({actions:N,subCategoryName:H,subCategoryId:me})=>e.createElement(ua,{key:H,actions:N,categoryName:O,isFormDisabled:i,subCategoryName:H,pathToData:[...h,me]})))))};eo.defaultProps={},eo.propTypes={childrenForm:s().array.isRequired,isOpen:s().bool.isRequired,isFormDisabled:s().bool.isRequired,isWhite:s().bool.isRequired,kind:s().string.isRequired,name:s().string.isRequired,onOpenCategory:s().func.isRequired,pathToData:s().array.isRequired};const da=eo,Oo=({isFormDisabled:a,kind:t,layout:o})=>{const[r,i]=(0,e.useState)(null),d=m=>{i(m===r?null:m)};return e.createElement(B.Box,{padding:6,background:"neutral0"},o.map(({category:m,categoryId:h,childrenForm:P},A)=>e.createElement(da,{key:m,childrenForm:P,kind:t,isFormDisabled:a,isOpen:r===m,isWhite:A%2===1,name:m,onOpenCategory:d,pathToData:[t,h]})))};Oo.propTypes={isFormDisabled:s().bool.isRequired,kind:s().string.isRequired,layout:s().arrayOf(s().shape({category:s().string.isRequired,categoryId:s().string.isRequired,childrenForm:s().arrayOf(s().shape({actions:s().array.isRequired})).isRequired}).isRequired).isRequired};const Ro=Oo,Do=(a,t,o)=>a.find(r=>r.action===t&&r.subject===o);var pa=Object.defineProperty,ma=Object.defineProperties,ga=Object.getOwnPropertyDescriptors,Lo=Object.getOwnPropertySymbols,fa=Object.prototype.hasOwnProperty,ha=Object.prototype.propertyIsEnumerable,xo=(a,t,o)=>t in a?pa(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Mo=(a,t)=>{for(var o in t||(t={}))fa.call(t,o)&&xo(a,o,t[o]);if(Lo)for(var o of Lo(t))ha.call(t,o)&&xo(a,o,t[o]);return a},Io=(a,t)=>ma(a,ga(t));const Fo=(a,t=[])=>a.reduce((o,r)=>(o[r.id]=t.indexOf(r.id)!==-1,o),{}),wo=({children:a},t,o="")=>a.reduce((r,i)=>{if(i.children)return Io(Mo({},r),{[i.value]:wo(i,t,`${o}${i.value}.`)});const d=t.indexOf(`${o}${i.value}`)!==-1;return r[i.value]=d,r},{}),ya=(a,t,o)=>a.reduce((r,i)=>{const d=t.properties.find(({value:m})=>m===i);if(d){const m=(0,y.get)(o,["properties",d.value],[]),h=wo(d,m);r.properties[i]=h}return r},{properties:{}}),va=(a,t)=>t.reduce((o,r)=>{const i=a.find(({uid:d})=>d===r)||null;return i&&(o[r]=i),o},{}),Bo=({subjects:a},t,o,r=[])=>t.reduce((i,d)=>{const m=d.subjects,h=va(a,m);if((0,y.isEmpty)(h))return i;const P=Object.keys(h).reduce((A,O)=>{const{actionId:N,applyToProperties:H}=d,G=h[O].properties.map(({value:Ce})=>Ce).every(Ce=>(H||[]).indexOf(Ce)===-1),M=Do(r,N,O),k=Fo(o,(0,y.get)(M,"conditions",[]));if((0,y.isEmpty)(H)||G)return(0,y.set)(A,[O,N],{properties:{enabled:M!==void 0},conditions:k}),A;const ae=ya(H,h[O],M);return(0,y.set)(A,[O,N],Io(Mo({},ae),{conditions:k})),A},{});return(0,y.merge)(i,P)},{}),Ca=(a,t,o)=>a.reduce((r,i)=>{const d=Do(o,i.action,null);return r[i.action]={properties:{enabled:d!==void 0},conditions:Fo(t,(0,y.get)(d,"conditions",[]))},r},{}),Ea=(a,t,o)=>a.reduce((r,i)=>(r[i.subCategoryId]=Ca(i.actions,t,o),r),{}),jo=(a,t,o=[])=>a.reduce((r,{categoryId:i,childrenForm:d})=>{const m=Ea(d,t,o);return r[i]=m,r},{}),No=a=>a.split(" ").join("-"),ko=(a,t)=>(0,y.chain)(a).groupBy(t).map((o,r)=>({category:r,categoryId:No(r),childrenForm:(0,y.chain)(o).groupBy("subCategory").map((i,d)=>({subCategoryName:d,subCategoryId:No(d),actions:i})).value()})).value(),ba=(a,t)=>{const{conditions:o,sections:{collectionTypes:r,singleTypes:i,plugins:d,settings:m}}=a,h={collectionTypes:r,singleTypes:i,plugins:ko(d,"plugin"),settings:ko(m,"category")},P={collectionTypes:Bo(r,r.actions||[],o,t),singleTypes:Bo(i,i.actions||[],o,t),plugins:jo(h.plugins,o,t),settings:jo(h.settings,o,t)};return{initialData:P,modifiedData:P,layouts:h}};var Sa=Object.defineProperty,Pa=Object.defineProperties,Ta=Object.getOwnPropertyDescriptors,Wo=Object.getOwnPropertySymbols,Aa=Object.prototype.hasOwnProperty,Oa=Object.prototype.propertyIsEnumerable,$o=(a,t,o)=>t in a?Sa(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,to=(a,t)=>{for(var o in t||(t={}))Aa.call(t,o)&&$o(a,o,t[o]);if(Wo)for(var o of Wo(t))Oa.call(t,o)&&$o(a,o,t[o]);return a},no=(a,t)=>Pa(a,Ta(t));const Uo=a=>Object.keys(a).reduce((t,o)=>{const r=a[o];if((0,y.isObject)(r)&&!(0,y.has)(r,"conditions"))return no(to({},t),{[o]:Uo(r)});if((0,y.isObject)(r)&&(0,y.has)(r,"conditions")&&!Dt((0,y.omit)(r,"conditions")).some(d=>d)){const d=Object.keys(r.conditions).reduce((m,h)=>(m[h]=!1,m),{});return no(to({},t),{[o]:no(to({},r),{conditions:d})})}return t[o]=r,t},{}),oo=Uo;var Ra=Object.defineProperty,Da=Object.defineProperties,La=Object.getOwnPropertyDescriptors,Go=Object.getOwnPropertySymbols,xa=Object.prototype.hasOwnProperty,Ma=Object.prototype.propertyIsEnumerable,Vo=(a,t,o)=>t in a?Ra(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Ia=(a,t)=>{for(var o in t||(t={}))xa.call(t,o)&&Vo(a,o,t[o]);if(Go)for(var o of Go(t))Ma.call(t,o)&&Vo(a,o,t[o]);return a},Fa=(a,t)=>Da(a,La(t));const Zo=(a,t)=>Object.keys(a).reduce((o,r)=>{const i=a[r];return r==="conditions"?(o[r]=i,o):(0,y.isObject)(i)?Fa(Ia({},o),{[r]:Zo(i,t)}):(o[r]=t,o)},{}),On=Zo;var wa=Object.defineProperty,Ba=Object.defineProperties,ja=Object.getOwnPropertyDescriptors,zo=Object.getOwnPropertySymbols,Na=Object.prototype.hasOwnProperty,ka=Object.prototype.propertyIsEnumerable,Ko=(a,t,o)=>t in a?wa(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,Wa=(a,t)=>{for(var o in t||(t={}))Na.call(t,o)&&Ko(a,o,t[o]);if(zo)for(var o of zo(t))ka.call(t,o)&&Ko(a,o,t[o]);return a},$a=(a,t)=>Ba(a,ja(t));const Ua={initialData:{},modifiedData:{},layouts:{}},Ga=(a,t)=>(0,Y.default)(a,o=>{switch(t.type){case"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX":{const{collectionTypeKind:r,actionId:i,value:d}=t,m=["modifiedData",r];Object.keys((0,y.get)(a,m)).forEach(h=>{const P=(0,y.get)(a,[...m,h,i],void 0);if(P){let A=On(P,d);if(!d&&A.conditions){const O=On(A.conditions,!1);A=$a(Wa({},A),{conditions:O})}(0,y.set)(o,[...m,h,i],A)}});break}case"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX":{const{pathToCollectionType:r,propertyName:i,rowName:d,value:m}=t;let h=(0,y.cloneDeep)(a.modifiedData);const P=r.split(".."),A=(0,y.get)(h,P,{});Object.keys(A).forEach(O=>{if((0,y.has)(A[O],`properties.${i}`)){const N=(0,y.get)(A,[O,"properties",i,d]),H=[...P,O,"properties",i,d];if(!(0,y.isObject)(N))(0,y.set)(h,H,m);else{const me=On(N,m);(0,y.set)(h,H,me)}}}),m||(h=oo(h)),(0,y.set)(o,"modifiedData",h);break}case"ON_CHANGE_CONDITIONS":{Object.entries(t.conditions).forEach(r=>{const[i,d]=r;(0,y.set)(o,["modifiedData",...i.split(".."),"conditions"],d)});break}case"ON_CHANGE_SIMPLE_CHECKBOX":{let r=(0,y.cloneDeep)(a.modifiedData);(0,y.set)(r,[...t.keys.split("..")],t.value),t.value||(r=oo(r)),(0,y.set)(o,"modifiedData",r);break}case"ON_CHANGE_TOGGLE_PARENT_CHECKBOX":{const{keys:r,value:i}=t,d=[...r.split("..")];let m=(0,y.cloneDeep)(a.modifiedData);const h=(0,y.get)(m,d,{}),P=On(h,i);(0,y.set)(m,d,P),i||(m=oo(m)),(0,y.set)(o,["modifiedData"],m);break}case"RESET_FORM":{o.modifiedData=a.initialData;break}case"SET_FORM_AFTER_SUBMIT":{o.initialData=a.modifiedData;break}default:return o}}),ao=a=>Object.entries(a).filter(([,t])=>t).map(([t])=>t),Va=a=>{const[t,{conditions:o}]=a;return{action:t,subject:null,conditions:ao(o),properties:{}}},Za=a=>Object.values(a).reduce((t,o)=>{const r=Object.entries(o).reduce((i,d)=>{const[,{properties:{enabled:m}}]=d;if(!m)return i;const h=Va(d);return i.push(h),i},[]);return[...t,...r]},[]),Ho=a=>Object.values(a).reduce((t,o)=>{const r=Za(o);return[...t,...r]},[]),Xo=(a,t="")=>Object.entries(a).reduce((o,r)=>{const[i,d]=r;return(0,y.isObject)(d)?[...o,...Xo(d,`${t}${i}.`)]:(d&&!(0,y.isObject)(d)&&o.push(`${t}${i}`),o)},[]),za=(a,t,{conditions:o,properties:r})=>Object.entries(r).reduce((i,d)=>{const[m,h]=d;return i.properties[m]=Xo(h),i},{action:a,subject:t,conditions:ao(o),properties:{}}),Ka=(a,t,{conditions:o})=>({action:a,subject:t,properties:{},conditions:ao(o)}),Ha=(a,t)=>Object.entries(t).reduce((r,i)=>{const[d,m]=i;if(!Dt(m).some(A=>A))return r;if(!(0,y.has)(m,"properties.enabled")){const A=za(d,a,m);return[...r,A]}if(!m.properties.enabled)return r;const P=Ka(d,a,m);return r.push(P),r},[]),Yo=a=>Object.entries(a).reduce((o,r)=>{const[i,d]=r,m=Ha(i,d);return[...o,...m]},[]),Xa=a=>{const t=Ho(a.plugins),o=Ho(a.settings),r=Yo(a.collectionTypes),i=Yo(a.singleTypes);return[...t,...o,...r,...i]},Ya=[{labelId:"app.components.LeftMenuLinkContainer.collectionTypes",defaultMessage:"Collection Types",id:"collectionTypes"},{labelId:"app.components.LeftMenuLinkContainer.singleTypes",id:"singleTypes",defaultMessage:"Single Types"},{labelId:"app.components.LeftMenuLinkContainer.plugins",defaultMessage:"Plugins",id:"plugins"},{labelId:"app.components.LeftMenuLinkContainer.settings",defaultMessage:"Settings",id:"settings"}];var Qa=Object.defineProperty,Qo=Object.getOwnPropertySymbols,Ja=Object.prototype.hasOwnProperty,qa=Object.prototype.propertyIsEnumerable,Jo=(a,t,o)=>t in a?Qa(a,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[t]=o,qo=(a,t)=>{for(var o in t||(t={}))Ja.call(t,o)&&Jo(a,o,t[o]);if(Qo)for(var o of Qo(t))qa.call(t,o)&&Jo(a,o,t[o]);return a};const ro=(0,e.forwardRef)(({layout:a,isFormDisabled:t,permissions:o},r)=>{const[{initialData:i,layouts:d,modifiedData:m},h]=(0,e.useReducer)(Ga,Ua,()=>ba(a,o)),{formatMessage:P}=(0,_.useIntl)();(0,e.useImperativeHandle)(r,()=>({getPermissions:()=>{const $=(0,z.difference)(i.collectionTypes,m.collectionTypes),G=(0,z.difference)(i.singleTypes,m.singleTypes),M=qo(qo({},$),G);let k;return Me()(M)?k=!1:k=Object.values(M).some(ae=>Object.values(ae).some(Ce=>le()(Ce,"conditions"))),{permissionsToSend:Xa(m),didUpdateConditions:k}},resetForm:()=>{h({type:"RESET_FORM"})},setFormAfterSubmit:()=>{h({type:"SET_FORM_AFTER_SUBMIT"})}}));const A=($,G,M,k)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_ROW_LEFT_CHECKBOX",pathToCollectionType:$,propertyName:G,rowName:M,value:k})},O=($,G,M)=>{h({type:"ON_CHANGE_COLLECTION_TYPE_GLOBAL_ACTION_CHECKBOX",collectionTypeKind:$,actionId:G,value:M})},N=$=>{h({type:"ON_CHANGE_CONDITIONS",conditions:$})},H=(0,e.useCallback)(({target:{name:$,value:G}})=>{h({type:"ON_CHANGE_SIMPLE_CHECKBOX",keys:$,value:G})},[]),me=(0,e.useCallback)(({target:{name:$,value:G}})=>{h({type:"ON_CHANGE_TOGGLE_PARENT_CHECKBOX",keys:$,value:G})},[]);return e.createElement(An,{value:{availableConditions:a.conditions,modifiedData:m,onChangeConditions:N,onChangeSimpleCheckbox:H,onChangeParentCheckbox:me,onChangeCollectionTypeLeftActionRowCheckbox:A,onChangeCollectionTypeGlobalActionCheckbox:O}},e.createElement(j.TabGroup,{id:"tabs",label:P({id:"Settings.permissions.users.tabs.label",defaultMessage:"Tabs Permissions"})},e.createElement(j.Tabs,null,Ya.map($=>e.createElement(j.Tab,{key:$.id},P({id:$.labelId,defaultMessage:$.defaultMessage})))),e.createElement(j.TabPanels,{style:{position:"relative"}},e.createElement(j.TabPanel,null,e.createElement(we,{layout:d.collectionTypes,kind:"collectionTypes",isFormDisabled:t})),e.createElement(j.TabPanel,null,e.createElement(we,{layout:d.singleTypes,kind:"singleTypes",isFormDisabled:t})),e.createElement(j.TabPanel,null,e.createElement(Ro,{layout:d.plugins,kind:"plugins",isFormDisabled:t})),e.createElement(j.TabPanel,null,e.createElement(Ro,{layout:d.settings,kind:"settings",isFormDisabled:t})))))});ro.defaultProps={permissions:[],layout:{conditions:[],sections:{collectionTypes:{},singleTypes:{actions:[]},settings:[],plugins:[]}}},ro.propTypes={layout:s().object,isFormDisabled:s().bool.isRequired,permissions:s().array};const _a=(0,e.memo)(ro)},34341:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!0},67500:(q,L,n)=>{"use strict";n.d(L,{Z:()=>e});const e=()=>"todo empty role"},52351:(q,L,n)=>{"use strict";n.d(L,{Z:()=>Xe});var e=n(67294),v=n(45697),s=n.n(v),z=n(5493),j=n.n(z),ie=n(67826),le=n.n(ie),ce=n(41798),Me=n.n(ce),_=n(49425),B=n.n(_),R=n(30741),Q=n.n(R),Pe=n(68547),X=n.n(Pe),de=n(97132),dt=n.n(de),it=Object.defineProperty,tt=Object.getOwnPropertySymbols,Ie=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable,E=(ye,fe,Re)=>fe in ye?it(ye,fe,{enumerable:!0,configurable:!0,writable:!0,value:Re}):ye[fe]=Re,Te=(ye,fe)=>{for(var Re in fe||(fe={}))Ie.call(fe,Re)&&E(ye,Re,fe[Re]);if(tt)for(var Re of tt(fe))ne.call(fe,Re)&&E(ye,Re,fe[Re]);return ye};const nt=({id:ye,name:fe,description:Re,usersCount:Ye,icons:lt})=>{const{formatMessage:pt}=(0,de.useIntl)(),Qe=pt({id:"Roles.RoleRow.user-count",defaultMessage:"{number, plural, =0 {#  user} one {#  user} other {# users}}"},{number:Ye});return e.createElement(ce.Tr,Te({key:ye},(0,Pe.onRowClick)({fn:lt[1].onClick})),e.createElement(ce.Td,{maxWidth:(0,Pe.pxToRem)(130)},e.createElement(_.Typography,{ellipsis:!0,textColor:"neutral800"},fe)),e.createElement(ce.Td,{maxWidth:(0,Pe.pxToRem)(250)},e.createElement(_.Typography,{ellipsis:!0,textColor:"neutral800"},Re)),e.createElement(ce.Td,null,e.createElement(_.Typography,{textColor:"neutral800"},Qe)),e.createElement(ce.Td,null,e.createElement(ie.Flex,Te({justifyContent:"flex-end"},Pe.stopPropagation),lt.map((je,ot)=>je?e.createElement(z.Box,{key:je.label,paddingLeft:ot===0?0:1},e.createElement(R.IconButton,{onClick:je.onClick,label:je.label,noBorder:!0,icon:je.icon})):null))))};nt.propTypes={id:s().number.isRequired,name:s().string.isRequired,description:s().string.isRequired,usersCount:s().number.isRequired,icons:s().array.isRequired};const Xe=nt},85302:(q,L,n)=>{"use strict";n.d(L,{Z:()=>gt});var e=n(67294),v=n(68547),s=n(87751),z=n(63852),j=n(80768),ie=n.n(j),le=n(18568),ce=n.n(le),Me=n(19352),_=n.n(Me),B=n(67483),R=n.n(B),Q=n(19408),Pe=n(78862),X=n(41798),de=n(49425),dt=n(62031),it=n(26851),tt=n(97132),Ie=n(49656),ne=n(52351),E=n(67500),Te=n(45697),nt=n.n(Te),Xe=n(78384),ye=n(59471),fe=n(24824),Re=n(30741),Ye=n(13260),lt=n(5493),pt=n(67826),Qe=n(9008),je=n(43257),ot=n.n(je),Ee=n(84040),mt=n.n(Ee);const w=n.p+"c3de6118ef47086ad05c.png",Y=n.p+"bd81ba6c07827282255d.png",V=Xe.default.div`
  position: absolute;
  z-index: 3;
  inset: 0;
  background: ${({theme:W})=>(0,v.setHexOpacity)(W.colors.neutral800,.2)};
  padding: 0 ${({theme:W})=>W.spaces[8]};
`,pe=(0,Xe.default)(pt.Flex)`
  position: relative;
  max-width: ${830/16}rem;
  height: ${415/16}rem;
  margin: 0 auto;
  overflow: hidden;
  margin-top: 10%;
  padding-left: ${64/16}rem;

  img:first-of-type {
    position: absolute;
    right: 0;
    top: 0;
    max-width: ${360/16}rem;
  }

  img:not(:first-of-type) {
    width: ${130/16}rem;
    margin-left: 12%;
    margin-right: ${20/16}rem;
    z-index: 0;
  }
`,Ae=(0,Xe.default)(Qe.Stack)`
  align-items: flex-start;
  max-width: ${400/16}rem;
  z-index: 0;
`,K=(0,Xe.default)(lt.Box)`
  position: absolute;
  right: ${({theme:W})=>W.spaces[4]};
  top: ${({theme:W})=>W.spaces[4]};
`,re=({onClose:W,isOpen:ee})=>{(0,v.useLockScroll)(ee);const{formatMessage:oe}=(0,tt.useIntl)();return ee?e.createElement(ye.Portal,null,e.createElement(V,{onClick:W},e.createElement(fe.FocusTrap,{onEscape:W},e.createElement(pe,{onClick:y=>y.stopPropagation(),"aria-labelledby":"upgrade-plan",background:"neutral0",hasRadius:!0},e.createElement("img",{src:w,alt:"air-balloon"}),e.createElement(K,null,e.createElement(Re.IconButton,{onClick:W,"aria-label":"Close",icon:e.createElement(mt(),null)})),e.createElement(Ae,{spacing:6},e.createElement(de.Typography,{fontWeight:"bold",textColor:"primary600"},oe({id:"app.components.UpgradePlanModal.text-ce",defaultMessage:"COMMUNITY EDITION"})),e.createElement(Qe.Stack,{spacing:2},e.createElement(de.Typography,{variant:"alpha",as:"h2",id:"upgrade-plan"},oe({id:"app.components.UpgradePlanModal.limit-reached",defaultMessage:"You have reached the limit"})),e.createElement(de.Typography,null,oe({id:"app.components.UpgradePlanModal.text-power",defaultMessage:"Unlock the full power of Strapi by upgrading your plan to the Enterprise Edition"}))),e.createElement(Ye.LinkButton,{href:"https://strapi.io/pricing-self-hosted",isExternal:!0,endIcon:e.createElement(ot(),null)},oe({id:"app.components.UpgradePlanModal.button",defaultMessage:"Learn more"}))),e.createElement("img",{src:Y,alt:"upgrade-arrow"}))))):null};re.propTypes={onClose:nt().func.isRequired,isOpen:nt().bool.isRequired};const he=re;var J=n(59942);const be=()=>{const{roles:W,isLoading:ee}=(0,J.bF)(),oe=(0,v.useQuery)(),y=decodeURIComponent(oe.get("_q")||""),Ve=(0,z.ZP)(W,y,{keys:["name","description"]});return{isLoading:ee,sortedRoles:Ve}},$e=()=>{const{formatMessage:W}=(0,tt.useIntl)(),[ee,oe]=(0,e.useState)(!1),{trackUsage:y}=(0,v.useTracking)(),{push:Ve}=(0,Ie.useHistory)(),ft=(0,e.useCallback)(Fe=>{Ve(`/settings/roles/${Fe}`)},[Ve]),ct=(0,e.useCallback)(()=>{oe(Fe=>!Fe)},[]),ue=(0,e.useCallback)(()=>{y("didShowRBACUpgradeModal"),oe(!0)},[y]),De=(0,e.useCallback)(Fe=>[{onClick:ct,label:W({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(R(),null)},{onClick:()=>ft(Fe.id),label:W({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(_(),null)},{onClick:ct,label:W({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(ce(),null)}],[W,ct,ft]);return{isModalOpen:ee,handleToggleModalForCreatingRole:ue,handleToggle:ct,getIcons:De}},rt=()=>{const{formatMessage:W}=(0,tt.useIntl)();(0,v.useFocusWhenNavigate)();const{sortedRoles:ee,isLoading:oe}=be(),{isModalOpen:y,handleToggle:Ve,handleToggleModalForCreatingRole:ft,getIcons:ct}=$e(),ue=ee.length+1,De=5;return e.createElement(dt.Main,null,e.createElement(v.SettingsPageTitle,{name:"Roles"}),e.createElement(Pe.HeaderLayout,{primaryAction:e.createElement(Q.Button,{onClick:ft,startIcon:e.createElement(ie(),null),size:"L"},W({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})),title:W({id:"global.roles",defaultMessage:"roles"}),subtitle:W({id:"Settings.roles.list.description",defaultMessage:"List of roles"})}),e.createElement(Pe.ContentLayout,null,e.createElement(X.Table,{colCount:De,rowCount:ue,footer:e.createElement(X.TFooter,{onClick:ft,icon:e.createElement(ie(),null)},W({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"}))},e.createElement(X.Thead,null,e.createElement(X.Tr,null,e.createElement(X.Th,null,e.createElement(de.Typography,{variant:"sigma",textColor:"neutral600"},W({id:"global.name",defaultMessage:"Name"}))),e.createElement(X.Th,null,e.createElement(de.Typography,{variant:"sigma",textColor:"neutral600"},W({id:"global.description",defaultMessage:"Description"}))),e.createElement(X.Th,null,e.createElement(de.Typography,{variant:"sigma",textColor:"neutral600"},W({id:"global.users",defaultMessage:"Users"}))),e.createElement(X.Th,null,e.createElement(it.VisuallyHidden,null,W({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(X.Tbody,null,ee==null?void 0:ee.map(Fe=>e.createElement(ne.Z,{key:Fe.id,id:Fe.id,name:Fe.name,description:Fe.description,usersCount:Fe.usersCount,icons:ct(Fe)})))),!ue&&!oe&&e.createElement(E.Z,null)),e.createElement(he,{isOpen:y,onClose:Ve}))},gt=()=>e.createElement(v.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(rt,null))},35301:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=[]},26789:(q,L,n)=>{"use strict";n.d(L,{Z:()=>ot});var e=n(67294),v=n(47292),s=n(68547),z=n(5493),j=n(19408),ie=n(78862),le=n(34626),ce=n(62031),Me=n(67826),_=n(9008),B=n(49425),R=n(55967),Q=n(59626),Pe=n(68717),X=n.n(Pe),de=n(80831),dt=n(27361),it=n.n(dt),tt=n(41609),Ie=n.n(tt),ne=n(97132),E=n(49656),Te=n(78384),nt=n(21568),Xe=n(59942),ye=n(87751),fe=n(53209);const Ye=fe.Ry().shape({name:fe.Z_().required(s.translatedErrors.required),description:fe.Z_().required(s.translatedErrors.required)});var lt=n(25108),pt=(Ee,mt,w)=>new Promise((Y,V)=>{var pe=re=>{try{K(w.next(re))}catch(he){V(he)}},Ae=re=>{try{K(w.throw(re))}catch(he){V(he)}},K=re=>re.done?Y(re.value):Promise.resolve(re.value).then(pe,Ae);K((w=w.apply(Ee,mt)).next())});const Qe=Te.default.div`
  border: 1px solid ${({theme:Ee})=>Ee.colors.primary200};
  background: ${({theme:Ee})=>Ee.colors.primary100};
  padding: ${({theme:Ee})=>`${Ee.spaces[2]} ${Ee.spaces[4]}`};
  color: ${({theme:Ee})=>Ee.colors.primary600};
  border-radius: ${({theme:Ee})=>Ee.borderRadius};
  font-size: ${12/16}rem;
  font-weight: bold;
`,je=()=>{const Ee=(0,s.useNotification)(),{lockApp:mt,unlockApp:w}=(0,s.useOverlayBlocker)(),{formatMessage:Y}=(0,ne.useIntl)(),[V,pe]=(0,e.useState)(!1),{replace:Ae}=(0,E.useHistory)(),K=(0,e.useRef)(),{trackUsage:re}=(0,s.useTracking)(),he=(0,E.useRouteMatch)("/settings/roles/duplicate/:id"),J=it()(he,"params.id",null),{isLoading:be,data:$e}=(0,Xe.U_)(),{permissions:at,isLoading:rt}=(0,Xe.Dq)(J),Et=W=>{mt(),pe(!0),re(J?"willDuplicateRole":"willCreateNewRole"),Promise.resolve((0,s.request)("/admin/roles",{method:"POST",body:W})).then(ee=>pt(void 0,null,function*(){const{permissionsToSend:oe}=K.current.getPermissions();return re(J?"didDuplicateRole":"didCreateNewRole"),ee.data.id&&!Ie()(oe)&&(yield(0,s.request)(`/admin/roles/${ee.data.id}/permissions`,{method:"PUT",body:{permissions:oe}})),ee})).then(ee=>{pe(!1),Ee({type:"success",message:{id:"Settings.roles.created",defaultMessage:"created"}}),Ae(`/settings/roles/${ee.data.id}`)}).catch(ee=>{lt.error(ee),pe(!1),Ee({type:"warning",message:{id:"notification.error"}})}).finally(()=>{w()})},gt=`${Y({id:"Settings.roles.form.created",defaultMessage:"Created"})} ${(0,v.format)(new Date,"PPP")}`;return e.createElement(ce.Main,null,e.createElement(s.SettingsPageTitle,{name:"Roles"}),e.createElement(de.Formik,{initialValues:{name:"",description:gt},onSubmit:Et,validationSchema:Ye,validateOnChange:!1},({handleSubmit:W,values:ee,errors:oe,handleReset:y,handleChange:Ve})=>e.createElement(s.Form,{noValidate:!0},e.createElement(e.Fragment,null,e.createElement(ie.HeaderLayout,{primaryAction:e.createElement(_.Stack,{horizontal:!0,spacing:2},e.createElement(j.Button,{variant:"secondary",onClick:()=>{y(),K.current.resetForm()},size:"L"},Y({id:"app.components.Button.reset",defaultMessage:"Reset"})),e.createElement(j.Button,{onClick:W,loading:V,size:"L"},Y({id:"global.save",defaultMessage:"Save"}))),title:Y({id:"Settings.roles.create.title",defaultMessage:"Create a role"}),subtitle:Y({id:"Settings.roles.create.description",defaultMessage:"Define the rights given to the role"}),navigationAction:e.createElement(s.Link,{startIcon:e.createElement(X(),null),to:"/settings/roles"},Y({id:"global.back",defaultMessage:"Back"}))}),e.createElement(ie.ContentLayout,null,e.createElement(_.Stack,{spacing:6},e.createElement(z.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(_.Stack,{spacing:4},e.createElement(Me.Flex,{justifyContent:"space-between"},e.createElement(z.Box,null,e.createElement(z.Box,null,e.createElement(B.Typography,{fontWeight:"bold"},Y({id:"global.details",defaultMessage:"Details"}))),e.createElement(z.Box,null,e.createElement(B.Typography,{variant:"pi",textColor:"neutral600"},Y({id:"Settings.roles.form.description",defaultMessage:"Name and description of the role"})))),e.createElement(Qe,null,Y({id:"Settings.roles.form.button.users-with-role",defaultMessage:"{number, plural, =0 {# users} one {# user} other {# users}} with this role"},{number:0}))),e.createElement(le.Grid,{gap:4},e.createElement(le.GridItem,{col:6},e.createElement(R.TextInput,{name:"name",error:oe.name&&Y({id:oe.name}),label:Y({id:"global.name",defaultMessage:"Name"}),onChange:Ve,value:ee.name})),e.createElement(le.GridItem,{col:6},e.createElement(Q.Textarea,{label:Y({id:"global.description",defaultMessage:"Description"}),name:"description",error:oe.description&&Y({id:oe.description}),onChange:Ve},ee.description))))),!be&&!rt?e.createElement(z.Box,{shadow:"filterShadow",hasRadius:!0},e.createElement(nt.Z,{isFormDisabled:!1,ref:K,permissions:at,layout:$e})):e.createElement(z.Box,{background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},e.createElement(s.LoadingIndicatorPage,null))))))))},ot=()=>e.createElement(s.CheckPagePermissions,{permissions:ye.Z.settings.roles.create},e.createElement(je,null))},53273:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!1},74512:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!1},76766:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!1},20591:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!1},85822:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!1},8629:(q,L,n)=>{"use strict";n.d(L,{Z:()=>v});const v=!1},64527:(q,L,n)=>{"use strict";n.d(L,{Z:()=>mt});var e=n(67294),v=n(68547),s=n(87751),z=n(80768),j=n.n(z),ie=n(18568),le=n.n(ie),ce=n(67483),Me=n.n(ce),_=n(19352),B=n.n(_),R=n(19408),Q=n(78862),Pe=n(26851),X=n(62031),de=n(41798),dt=n(49425),it=n(96486),tt=n(63852),Ie=n(97132),ne=n(49656),E=n(23998),Te=n(59942),nt=n(67500),Xe=n(52351),ye=n(73749);const fe={roleToDelete:null,showModalConfirmButtonLoading:!1,shouldRefetchData:!1},Ye=(w,Y)=>(0,ye.default)(w,V=>{switch(Y.type){case"ON_REMOVE_ROLES":{V.showModalConfirmButtonLoading=!0;break}case"ON_REMOVE_ROLES_SUCCEEDED":{V.shouldRefetchData=!0,V.roleToDelete=null;break}case"RESET_DATA_TO_DELETE":{V.shouldRefetchData=!1,V.roleToDelete=null,V.showModalConfirmButtonLoading=!1;break}case"SET_ROLE_TO_DELETE":{V.roleToDelete=Y.id;break}default:return V}});var lt=(w,Y,V)=>new Promise((pe,Ae)=>{var K=J=>{try{he(V.next(J))}catch(be){Ae(be)}},re=J=>{try{he(V.throw(J))}catch(be){Ae(be)}},he=J=>J.done?pe(J.value):Promise.resolve(J.value).then(K,re);he((V=V.apply(w,Y)).next())});const pt=()=>{(0,v.useFocusWhenNavigate)();const{isLoading:w,allowedActions:{canCreate:Y,canDelete:V,canRead:pe,canUpdate:Ae}}=(0,v.useRBAC)(s.Z.settings.roles),{getData:K,roles:re,isLoading:he}=(0,Te.bF)(!1),[{query:J}]=(0,v.useQueryParams)(),be=(J==null?void 0:J._q)||"",$e=(0,tt.ZP)(re,be,{keys:["name","description"]});return(0,e.useEffect)(()=>{!w&&pe&&K()},[w,pe,K]),{isLoadingForPermissions:w,canCreate:Y,canDelete:V,canRead:pe,canUpdate:Ae,isLoading:he,getData:K,sortedRoles:$e,roles:re}},Qe=({getData:w,canCreate:Y,canDelete:V,canUpdate:pe})=>{const{formatMessage:Ae}=(0,Ie.useIntl)(),K=(0,v.useNotification)(),[re,he]=(0,e.useState)(!1),{push:J}=(0,ne.useHistory)(),[{selectedRoles:be,showModalConfirmButtonLoading:$e,roleToDelete:at},rt]=(0,e.useReducer)(Ye,fe),Et=()=>lt(void 0,null,function*(){try{rt({type:"ON_REMOVE_ROLES"}),yield E.be.post("/admin/roles/batch-delete",{ids:[at]}),yield w(),rt({type:"RESET_DATA_TO_DELETE"})}catch(ue){const De=(0,it.get)(ue,["response","payload","data","ids"],null);if(De&&Array.isArray(De)){const Fe=De.join(`
`);K({type:"warning",message:Fe})}else K({type:"warning",message:{id:"notification.error"}})}oe()}),gt=(0,e.useCallback)(ue=>{J(`/settings/roles/duplicate/${ue}`)},[J]),W=()=>J("/settings/roles/new"),ee=(0,e.useCallback)(ue=>{rt({type:"SET_ROLE_TO_DELETE",id:ue}),oe()},[]),oe=()=>he(ue=>!ue),y=(0,e.useCallback)(ue=>{J(`/settings/roles/${ue}`)},[J]),Ve=(0,e.useCallback)((ue,De)=>{ue.preventDefault(),ue.stopPropagation(),De.usersCount?K({type:"info",message:{id:"Roles.ListPage.notification.delete-not-allowed"}}):ee(De.id)},[K,ee]),ft=(0,e.useCallback)((ue,De)=>{ue.preventDefault(),ue.stopPropagation(),gt(De.id)},[gt]),ct=(0,e.useCallback)(ue=>[...Y?[{onClick:De=>ft(De,ue),label:Ae({id:"app.utils.duplicate",defaultMessage:"Duplicate"}),icon:e.createElement(Me(),null)}]:[],...pe?[{onClick:()=>y(ue.id),label:Ae({id:"app.utils.edit",defaultMessage:"Edit"}),icon:e.createElement(B(),null)}]:[],...V?[{onClick:De=>Ve(De,ue),label:Ae({id:"global.delete",defaultMessage:"Delete"}),icon:e.createElement(le(),null)}]:[]],[Ae,Ve,ft,y,Y,pe,V]);return{handleNewRoleClick:W,getIcons:ct,selectedRoles:be,isWarningDeleteAllOpened:re,showModalConfirmButtonLoading:$e,handleToggleModal:oe,handleDeleteData:Et}},ot=()=>{const{formatMessage:w}=(0,Ie.useIntl)(),{isLoadingForPermissions:Y,canCreate:V,canRead:pe,canDelete:Ae,canUpdate:K,isLoading:re,getData:he,sortedRoles:J}=pt(),{handleNewRoleClick:be,getIcons:$e,isWarningDeleteAllOpened:at,showModalConfirmButtonLoading:rt,handleToggleModal:Et,handleDeleteData:gt}=Qe({getData:he,canCreate:V,canDelete:Ae,canUpdate:K}),W=J.length+1,ee=6;if(Y)return e.createElement(X.Main,null,e.createElement(v.LoadingIndicatorPage,null));const oe=w({id:"global.roles",defaultMessage:"roles"});return e.createElement(X.Main,null,e.createElement(v.SettingsPageTitle,{name:"Roles"}),e.createElement(Q.HeaderLayout,{primaryAction:V?e.createElement(R.Button,{onClick:be,startIcon:e.createElement(j(),null),size:"L"},w({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null,title:oe,subtitle:w({id:"Settings.roles.list.description",defaultMessage:"List of roles"}),as:"h2"}),pe&&e.createElement(Q.ActionLayout,{startActions:e.createElement(v.SearchURLQuery,{label:w({id:"app.component.search.label",defaultMessage:"Search for {target}"},{target:oe})})}),pe&&e.createElement(Q.ContentLayout,null,e.createElement(de.Table,{colCount:ee,rowCount:W,footer:V?e.createElement(de.TFooter,{onClick:be,icon:e.createElement(j(),null)},w({id:"Settings.roles.list.button.add",defaultMessage:"Add new role"})):null},e.createElement(de.Thead,null,e.createElement(de.Tr,null,e.createElement(de.Th,null,e.createElement(dt.Typography,{variant:"sigma",textColor:"neutral600"},w({id:"global.name",defaultMessage:"Name"}))),e.createElement(de.Th,null,e.createElement(dt.Typography,{variant:"sigma",textColor:"neutral600"},w({id:"global.description",defaultMessage:"Description"}))),e.createElement(de.Th,null,e.createElement(dt.Typography,{variant:"sigma",textColor:"neutral600"},w({id:"global.users",defaultMessage:"Users"}))),e.createElement(de.Th,null,e.createElement(Pe.VisuallyHidden,null,w({id:"global.actions",defaultMessage:"Actions"}))))),e.createElement(de.Tbody,null,J==null?void 0:J.map(y=>e.createElement(Xe.Z,{key:y.id,id:y.id,name:y.name,description:y.description,usersCount:y.usersCount,icons:$e(y)})))),!W&&!re&&e.createElement(nt.Z,null)),e.createElement(v.ConfirmDialog,{isOpen:at,onConfirm:gt,isConfirmButtonLoading:rt,onToggleDialog:Et}))},mt=()=>e.createElement(v.CheckPagePermissions,{permissions:s.Z.settings.roles.main},e.createElement(ot,null))},5420:(q,L,n)=>{"use strict";n.d(L,{Z:()=>z});var e=(j,ie,le)=>new Promise((ce,Me)=>{var _=Q=>{try{R(le.next(Q))}catch(Pe){Me(Pe)}},B=Q=>{try{R(le.throw(Q))}catch(Pe){Me(Pe)}},R=Q=>Q.done?ce(Q.value):Promise.resolve(Q.value).then(_,B);R((le=le.apply(j,ie)).next())});const z=[...strapi.features.isEnabled(strapi.features.SSO)?[{Component:()=>e(void 0,null,function*(){return yield n.e(302).then(n.bind(n,29808))}),to:"/settings/single-sign-on",exact:!0}]:[]]},44174:q=>{function L(n,e,v,s){for(var z=-1,j=n==null?0:n.length;++z<j;){var ie=n[z];e(s,ie,v(ie),n)}return s}q.exports=L},81119:(q,L,n)=>{var e=n(89881);function v(s,z,j,ie){return e(s,function(le,ce,Me){z(ie,le,j(le),Me)}),ie}q.exports=v},55189:(q,L,n)=>{var e=n(44174),v=n(81119),s=n(67206),z=n(1469);function j(ie,le){return function(ce,Me){var _=z(ce)?e:v,B=le?le():{};return _(ce,ie,s(Me,2),B)}}q.exports=j},94654:(q,L,n)=>{var e=n(21078),v=n(35161);function s(z,j){return e(v(z,j),1)}q.exports=s},7739:(q,L,n)=>{var e=n(89465),v=n(55189),s=Object.prototype,z=s.hasOwnProperty,j=v(function(ie,le,ce){z.call(ie,ce)?ie[ce].push(le):e(ie,ce,[le])});q.exports=j}}]);
